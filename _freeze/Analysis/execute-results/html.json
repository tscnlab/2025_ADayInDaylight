{
  "hash": "1969af60b207e557a049208b87eb7b0a",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"A day in daylight\"\nauthor: \n  - name: \"Johannes Zauner\"\n    affiliation: \"Technical University of Munich & Max Planck Institute for Biological Cybernetics, Germany\"\n    orcid: \"0000-0003-2171-4566\"\n  - name: \"Resshaya Roobini Murukesu\"\n    affiliation: \"TUMCREATE Ltd. (Singapore)\"\n    orcid: \"0000-0002-0947-5817\"\n  - name: \"Manuel Spitschan\"\n    affiliation: \"Technical University of Munich & Max Planck Institute for Biological Cybernetics, Germany\"      \n    orcid: \"0000-0002-8572-9268\"\nformat: \n  html:\n    self-contained: true\n    code-tools: true\n    toc: true\n    code-linking: true\n---\n\n\n\n## Preface\n\nThis document contains the analysis and results for the event **A day in daylight**, where people from around the world measured a complete day of light exposure on (and around) **22 September 2025**.\n\n::: {.callout-note}\nNote that this script is optimized to generate plot outputs and objects to implement in a dashboard. Thus the direct outputs of the script might look distorted in places.\n:::\n\n## Importing data\n\nWe first set up all packages needed for the analysis\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(LightLogR)\nlibrary(Hmisc)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\nAttaching package: 'Hmisc'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nThe following objects are masked from 'package:base':\n\n    format.pval, units\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.0     ✔ stringr   1.5.1\n✔ ggplot2   4.0.0     ✔ tibble    3.3.0\n✔ lubridate 1.9.4     ✔ tidyr     1.3.1\n✔ purrr     1.1.0     \n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter()    masks stats::filter()\n✖ dplyr::lag()       masks stats::lag()\n✖ dplyr::src()       masks Hmisc::src()\n✖ dplyr::summarize() masks Hmisc::summarize()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(gt)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\nAttaching package: 'gt'\n\nThe following object is masked from 'package:Hmisc':\n\n    html\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(patchwork)\nlibrary(gtExtras)\nlibrary(gtsummary)\nlibrary(legendry)\nlibrary(rlang)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\nAttaching package: 'rlang'\n\nThe following objects are masked from 'package:purrr':\n\n    %@%, flatten, flatten_chr, flatten_dbl, flatten_int, flatten_lgl,\n    flatten_raw, invoke, splice\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(gganimate)\nlibrary(ggdist)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\nAttaching package: 'ggdist'\n\nThe following object is masked from 'package:rlang':\n\n    ll\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(sf)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nLinking to GEOS 3.13.0, GDAL 3.8.5, PROJ 9.5.1; sf_use_s2() is TRUE\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(rnaturalearth)\nlibrary(rnaturalearthdata)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\nAttaching package: 'rnaturalearthdata'\n\nThe following object is masked from 'package:rnaturalearth':\n\n    countries110\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(ggplot2)\nlibrary(glue)\nlibrary(suncalc)\nlibrary(scales)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\nAttaching package: 'scales'\n\nThe following object is masked from 'package:purrr':\n\n    discard\n\nThe following object is masked from 'package:readr':\n\n    col_factor\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(progress)\n\n# source(\"https://raw.githubusercontent.com/MeLiDosProject/Data_Metadata_Conventions/main/scripts/overview_plot.R\")\n```\n:::\n\n\n\nNext we import the survey data. Data were collected with REDCap, and there is an import script to load the data in.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsource(\"scripts/prep_survey_data.r\")\n```\n:::\n\n\n\n### Connecting light data with survey data\n\nFirst, we collect a list of available data sets. As we need to compare them to the device ids in the survey, we require only the file without path or extension\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npath_light <- \"data/lightloggers\"\nfiles_light <- list.files(path_light) |> tools::file_path_sans_ext()\n```\n:::\n\n\n\nNext we check which devices are declared in the survey.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsurvey_devices <- data |> drop_na(device_id) |> pull(device_id) #get devices\nsurvey_devices |> anyDuplicated() #are any entries duplicated?: No\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0\n```\n\n\n:::\n\n```{.r .cell-code}\nsurvey_devices |> setequal(files_light) #are light files and survey entries equal?: Yes\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] TRUE\n```\n\n\n:::\n:::\n\n\n\nNo entries are duplicated and the survey device Ids are equal to the light files. \n\n### Device and location information\n\nNext, we need to get the time zones of the participants and their coordinates. For this, let's reduce the complexity of the dataset and clean the data\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_devices <- \ndata |> \n  drop_na(device_id) |> \n  select(device_id, record_id, \n         city_country, latitude, longitude,\n         age, sex = sex.factor,\n         complete_log = complete_log.factor,\n         behaviour_change = behaviour_change.factor,\n         travel_time_zone) |> \n  mutate(travel_time_zone = travel_time_zone == 1)\nlabel(data_devices$travel_time_zone) = \"Time zone travel\"\nlabel(data_devices$age) = \"age\"\nlabel(data_devices$behaviour_change) = \"Behaviour change\"\n\ndata_devices |> gt() |> opt_interactive()\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"beonmsscwk\" class=\".gt_table\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#beonmsscwk table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#beonmsscwk thead, #beonmsscwk tbody, #beonmsscwk tfoot, #beonmsscwk tr, #beonmsscwk td, #beonmsscwk th {\n  border-style: none;\n}\n\n#beonmsscwk p {\n  margin: 0;\n  padding: 0;\n}\n\n#beonmsscwk .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#beonmsscwk .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#beonmsscwk .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#beonmsscwk .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#beonmsscwk .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#beonmsscwk .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#beonmsscwk .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#beonmsscwk .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#beonmsscwk .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#beonmsscwk .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#beonmsscwk .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#beonmsscwk .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#beonmsscwk .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#beonmsscwk .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#beonmsscwk .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#beonmsscwk .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#beonmsscwk .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#beonmsscwk .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#beonmsscwk .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#beonmsscwk .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#beonmsscwk .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#beonmsscwk .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#beonmsscwk .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#beonmsscwk .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#beonmsscwk .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#beonmsscwk .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#beonmsscwk .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#beonmsscwk .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#beonmsscwk .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#beonmsscwk .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#beonmsscwk .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#beonmsscwk .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#beonmsscwk .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#beonmsscwk .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#beonmsscwk .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#beonmsscwk .gt_left {\n  text-align: left;\n}\n\n#beonmsscwk .gt_center {\n  text-align: center;\n}\n\n#beonmsscwk .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#beonmsscwk .gt_font_normal {\n  font-weight: normal;\n}\n\n#beonmsscwk .gt_font_bold {\n  font-weight: bold;\n}\n\n#beonmsscwk .gt_font_italic {\n  font-style: italic;\n}\n\n#beonmsscwk .gt_super {\n  font-size: 65%;\n}\n\n#beonmsscwk .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#beonmsscwk .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#beonmsscwk .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#beonmsscwk .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#beonmsscwk .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#beonmsscwk .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#beonmsscwk .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#beonmsscwk .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#beonmsscwk div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<div id=\"beonmsscwk\" class=\"reactable html-widget\" style=\"width:auto;height:auto;\"></div>\n<script type=\"application/json\" data-for=\"beonmsscwk\">{\"x\":{\"tag\":{\"name\":\"Reactable\",\"attribs\":{\"data\":{\"device_id\":[5812,6199,3781,3333,4081,5777,5875,3564,4103,6699,4067,2003462,6441,4394,6499,3899,5716,3868,6471,4536,5349,4524,6334,5655,3771,3887,2003460,2215,6275,4396,5399,6837,6305,6189,5935,2003249,6253,5308,3852,6293,5692,4023,4914,5163,5160,5090,5110,5236,6011,4789],\"record_id\":[3,4,5,6,7,8,9,10,11,12,13,15,16,17,18,19,20,21,23,24,25,26,27,28,29,30,31,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56],\"city_country\":[\"Riehen, Switzerland\",\"Madrid\",\"Bochum, Germany\",\"Kumasi, Ghana\",\"Germany, Dortmund\",\"antalya, turkey\",\"Eindhoven, The Netherlands\",\"Dortmund, Germany\",\"Dortmund, Germany\",\"Tuebingen, Germany\",\"Berlin (Sun 12-Mon 9) and Dortmund (Mon 12-Tue 14)\",\"Berlin and Southern Brandenburg\",\"Tübingen, Germany\",\"Dortmund, Germany\",\"Tübingen, Germany\",\"SU VELBERT; MO /TU Dortmund - Germany (both)\",\"Izmir, Turkey\",\"Dortmund, Germany\",\"Shenzhen, China\",\"Izmir/Türkiye\",\"Johor Bahru, Malaysia and Singapore\",\"İzmir Turkiye\",\"Philadelphia, United States\",\"Kongsberg, Norway\",\"Dortmund, Germany\",\"Dortmund, Germany\",\"\",\"Guildford, UK\",\"Dublin (half) Madrid (half)\",\"Borås, Sweden and Helsinki, Finland\",\"Tübingen, Germany\",\"San José, Costa Rica\",\"San José, Costa Rica\",\"Havertown, Pennsylvania, USA\",\"Eindhoven, the Netherlands \",\"Velbert, Hilden /Germany\",\"Liberia, Costa Rica\",\"Zurich, Switzerland\",\"league city, texas 77573\",\"MADRID\",\"Kongsberg, Norway\",\"Berlin, Germany\",\"San Jose, CA, USA\",\"Mountain View, CA, USA\",\"El Cerrito, Oakland, and Berkeley, CA (on Sunday) / Mountain View, CA (On Monday)\",\"San Francisco, CA; San Carlos, CA - USA\",\"San Leandro, CA; Mountain View, CA\",\"San Jose, California\",\"Melbourne, Victoria \",\"Munich, Germany\"],\"latitude\":[\"47°34′23″ N\",\"40°31′30″ North or 40,523106° North\",\"51°28'48.9'N\",\"6.69097 N\",\"51.5136° N\",\"36.9N\",\"51.4485802\",\"51° 30′ 51″ N\",\"N 51°30'2\",\"48.53\",\"52°30'43.9'N and 51°31'04.5'N\",\"52° 14′ N\",\"48,53675° N\",\" 51° 30′ 51″ N\",\"48.5216° N\",\"V: 51°20'07'N; DO 51°30'36'N\",\"38.1967207\",\"51.5\",\"22° N\",\"Turkey38.32985326.639836\",\"Johor Bahru: 103.7643° E; Singapore: 103.8198° E\",\"38.332610\",\"40.1417\",\"59.6759766\",\"51.5\",\"51.49854 \",\"\",\"51.2354\",\"53,35\",\"57,72 Borås; 60,17 Helsinki\",\"48.5366° N\",\"9°50' N\",\"9,94365\",\"39.9763656\",\"51.4416\",\"51° 20´N\",\"10.63517\",\"47.4\",\"29.487\",\"40°30′N\",\"59°39′ N\",\"52,5\",\"37.414971\",\"37.4145646\",\"37.9161° N\",\"37.7502 N\",\" 37.67° North\",\"37.20° N\",\"37.80\",\"48° 08' 6.00' N\"],\"longitude\":[\"7°38′39″ E\",\"718 m\",\"7°14'16.7'E\",\"1.61613 W\",\"7.4653° E\",\"30.7E\",\"5.4860307\",\"7° 27′ 50″ E\",\"E7°28'2\",\"9.069\",\"13°20'47.5'E and 7°27'25.7'E\",\"13° 38′ O\",\"9,05931° E\",\"7° 27′ 50″ O\",\"9.0576° E\",\"V: 07°30'36'N; DO 07°27'57'\",\"26.8391099\",\"7.4\",\"114° E\",\"Turkey38.32985326.639836\",\"Johor Bahru: 1.4799° N; Singapore: 1.3521° N\",\"26.645070\",\"75.1927\",\"9.6534677\",\"7.3\",\"7.41701\",\"\",\"-0.5743\",\"-6,26\",\"12,94 Borås; 24,94 Helsinki\",\"9.0576° E\",\"84°00' O\",\"84,17604\",\"-75.3149796 \",\"5.4697\",\"7° 3´O\",\"-85.43779\",\"8.5\",\"95.109\",\"3°40′W\",\"9°39′ E\",\"13,6\",\"-122.059474\",\"-122.0524302\",\"122.3108° W\",\"122.3801 W\",\"-122.08° West longitude\",\"-121.53° W \",\"144.96\",\"11° 34' 11.99' E\"],\"age\":[32,57,35,26,40,33,26,40,26,41,46,49,24,70,28,53,24,41,26,24,33,24,41,42,60,33,62,31,52,51,38,27,43,50,41,56,23,48,64,46,55,36,29,22,35,41,24,54,33,22],\"sex\":[\"Female\",\"Male\",\"Male\",\"Male\",\"Male\",\"Male\",\"Female\",\"Male\",\"Male\",\"Female\",\"Male\",\"Male\",\"Male\",\"Female\",\"Female\",\"Female\",\"Male\",\"Male\",\"Female\",\"Female\",\"Female\",\"Female\",\"Female\",\"Male\",\"Male\",\"Female\",\"Male\",\"Female\",\"Female\",\"Female\",\"Female\",\"Male\",\"Female\",\"Female\",\"Female\",\"Male\",\"Female\",\"Female\",\"Female\",\"Female\",\"Female\",\"Female\",\"Male\",\"Female\",\"Female\",\"Female\",\"Female\",\"Female\",\"Female\",\"Female\"],\"complete_log\":[\"3\",\"4\",\"1\",\"5\",\"2\",\"4\",\"4\",\"2\",\"4\",\"4\",\"4\",\"4\",\"3\",\"5\",\"4\",\"3\",\"4\",\"4\",\"4\",\"5\",\"3\",\"5\",\"4\",\"3\",\"2\",\"4\",null,\"4\",\"4\",\"2\",\"4\",\"4\",\"2\",\"4\",\"3\",\"1\",\"3\",\"4\",\"4\",\"4\",\"4\",\"3\",\"3\",\"2\",\"4\",\"4\",\"2\",\"5\",\"3\",\"2\"],\"behaviour_change\":[\"No\",\"No\",\"No\",\"No\",\"Yes, significantly\",\"No\",\"No\",\"Yes, somewhat\",\"No\",\"Yes, somewhat\",\"No\",\"No\",\"Yes, somewhat\",\"No\",\"No\",\"Yes, somewhat\",\"No\",\"No\",\"No\",\"No\",\"No\",\"No\",\"No\",\"No\",\"No\",\"No\",null,\"No\",\"No\",\"No\",\"No\",\"Yes, somewhat\",\"No\",\"No\",\"No\",\"No\",\"Yes, significantly\",\"No\",\"No\",\"No\",\"Yes, somewhat\",\"No\",\"No\",\"Yes, significantly\",\"No\",\"No\",\"No\",\"Yes, somewhat\",\"No\",\"No\"],\"travel_time_zone\":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,null,false,true,true,false,false,false,false,false,false,false,true,false,true,false,false,false,false,false,false,false,false,false,false]},\"columns\":[{\"id\":\"device_id\",\"name\":\"Device ID\",\"type\":\"numeric\",\"na\":\"NA\",\"minWidth\":125,\"style\":\"function(rowInfo, colInfo) {\\nconst rowIndex = rowInfo.index + 1\\n}\",\"html\":true,\"align\":\"center\"},{\"id\":\"record_id\",\"name\":\"Record ID\",\"type\":\"numeric\",\"na\":\"NA\",\"minWidth\":125,\"style\":\"function(rowInfo, colInfo) {\\nconst rowIndex = rowInfo.index + 1\\n}\",\"html\":true,\"align\":\"center\"},{\"id\":\"city_country\",\"name\":\"City and country\",\"type\":[\"labelled\",\"character\"],\"na\":\"NA\",\"minWidth\":125,\"style\":\"function(rowInfo, colInfo) {\\nconst rowIndex = rowInfo.index + 1\\n}\",\"html\":true,\"align\":\"center\"},{\"id\":\"latitude\",\"name\":\"Latitude\",\"type\":[\"labelled\",\"character\"],\"na\":\"NA\",\"minWidth\":125,\"style\":\"function(rowInfo, colInfo) {\\nconst rowIndex = rowInfo.index + 1\\n}\",\"html\":true,\"align\":\"center\"},{\"id\":\"longitude\",\"name\":\"Longitude \",\"type\":[\"labelled\",\"character\"],\"na\":\"NA\",\"minWidth\":125,\"style\":\"function(rowInfo, colInfo) {\\nconst rowIndex = rowInfo.index + 1\\n}\",\"html\":true,\"align\":\"center\"},{\"id\":\"age\",\"name\":\"age\",\"type\":\"numeric\",\"na\":\"NA\",\"minWidth\":125,\"style\":\"function(rowInfo, colInfo) {\\nconst rowIndex = rowInfo.index + 1\\n}\",\"html\":true,\"align\":\"center\"},{\"id\":\"sex\",\"name\":\"sex\",\"type\":\"factor\",\"na\":\"NA\",\"minWidth\":125,\"style\":\"function(rowInfo, colInfo) {\\nconst rowIndex = rowInfo.index + 1\\n}\",\"html\":true,\"align\":\"center\"},{\"id\":\"complete_log\",\"name\":\"complete_log\",\"type\":\"factor\",\"na\":\"NA\",\"minWidth\":125,\"style\":\"function(rowInfo, colInfo) {\\nconst rowIndex = rowInfo.index + 1\\n}\",\"html\":true,\"align\":\"center\"},{\"id\":\"behaviour_change\",\"name\":\"Behaviour change\",\"type\":[\"labelled\",\"factor\"],\"na\":\"NA\",\"minWidth\":125,\"style\":\"function(rowInfo, colInfo) {\\nconst rowIndex = rowInfo.index + 1\\n}\",\"html\":true,\"align\":\"center\"},{\"id\":\"travel_time_zone\",\"name\":\"Time zone travel\",\"type\":[\"labelled\",\"logical\"],\"na\":\"NA\",\"minWidth\":125,\"style\":\"function(rowInfo, colInfo) {\\nconst rowIndex = rowInfo.index + 1\\n}\",\"html\":true,\"align\":\"center\"}],\"defaultPageSize\":10,\"showPageSizeOptions\":false,\"pageSizeOptions\":[10,25,50,100],\"paginationType\":\"numbers\",\"showPagination\":true,\"showPageInfo\":true,\"minRows\":1,\"height\":\"auto\",\"theme\":{\"color\":\"#333333\",\"backgroundColor\":\"#FFFFFF\",\"stripedColor\":\"rgba(128,128,128,0.05)\",\"style\":{\"font-family\":\"system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif\",\"fontSize\":\"16px\"},\"tableStyle\":{\"borderTopStyle\":\"solid\",\"borderTopWidth\":\"2px\",\"borderTopColor\":\"#D3D3D3\"},\"headerStyle\":{\"fontWeight\":\"normal\",\"backgroundColor\":\"transparent\",\"borderBottomStyle\":\"solid\",\"borderBottomWidth\":\"2px\",\"borderBottomColor\":\"#D3D3D3\"},\"groupHeaderStyle\":{\"fontWeight\":\"normal\",\"backgroundColor\":\"transparent\",\"borderBottomStyle\":\"solid\",\"borderBottomWidth\":\"2px\",\"borderBottomColor\":\"#D3D3D3\"},\"cellStyle\":{\"fontWeight\":\"normal\"}},\"elementId\":\"beonmsscwk\",\"dataKey\":\"46cbf145f4084e70635172eb811477fb\"},\"children\":[]},\"class\":\"reactR_markup\"},\"evals\":[\"tag.attribs.columns.0.style\",\"tag.attribs.columns.1.style\",\"tag.attribs.columns.2.style\",\"tag.attribs.columns.3.style\",\"tag.attribs.columns.4.style\",\"tag.attribs.columns.5.style\",\"tag.attribs.columns.6.style\",\"tag.attribs.columns.7.style\",\"tag.attribs.columns.8.style\",\"tag.attribs.columns.9.style\"],\"jsHooks\":[]}</script>\n</div>\n```\n\n:::\n:::\n\n\n\n`Record ID 31` did not finish the post-survey, so we lack data on that device and consequently remove it. Furthermore, `Record ID 30` only has data much outside the time frame of interest. `Record ID 40` don't has sensible data and will also be removed. Likely some issue with a dead battery is the reason.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_devices <- data_devices |> filter(!record_id %in% c(\"31\", \"30\", \"44\"))\n```\n:::\n\n\n\nWe also have to clean up the city and country, as well as latitude and longitude data. We do this separately and load the data back in.\nThe manual entries for locations had to be cleaned. This was done with OpenAI through an API key. The results were stored in the file `data/cleaned/places.csv`. Uncomment the code cell below to recreate the process. Details in outcome may vary, however.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# library(ellmer)\n# \n# data_devices_red <- \n# data_devices |> \n#   select(record_id, city_country, latitude, longitude)\n# \n# chat <- chat_openai(\"If there is more then one place specified, only use the first one. If latitude and longitude are misspecified, make a best guess based on city_country. Use IANA names for the time zone identifieres\")\n# \n# #reducing each line in a table to a single string\n# data_devices_red <- \n# data_devices_red |> \n#   pmap(~ paste(paste(names(data_devices_red), c(...), sep = \": \"), collapse = \", \"))\n# \n# #creating an output structure\n# type_place <- type_object(\n#   record_id = type_string(),\n#   city = type_string(),\n#   country = type_string(),\n#   latitude = type_number(),\n#   longitude = type_number(),\n#   tz_identifier = type_string(),\n#   UTC_dev = type_number(\"deviation from UTC in hours, given the 22 September 2025\")\n# )\n# \n# places <-\n# parallel_chat_structured(\n#   chat,\n#   data_devices_red,\n#   type = type_place\n# )\n# \n# write.csv(places, \"data/cleaned/places.csv\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#read pre-cleaned data in\nplaces <- read_csv(\"data/cleaned/places.csv\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nNew names:\nRows: 49 Columns: 8\n── Column specification\n──────────────────────────────────────────────────────── Delimiter: \",\" chr\n(3): city, country, tz_identifier dbl (5): ...1, record_id, latitude,\nlongitude, UTC_dev\nℹ Use `spec()` to retrieve the full column specification for this data. ℹ\nSpecify the column types or set `show_col_types = FALSE` to quiet this message.\n• `` -> `...1`\n```\n\n\n:::\n\n```{.r .cell-code}\nplaces <- \n  places |> \n  dplyr::mutate(record_id = as.character(record_id)) |> \n  select(-`...1`)\n\n#merge data with main data\ndata_devices_cleaned <- \ndata_devices |> \n  select(-city_country, -latitude, -longitude) |> \n  mutate(record_id = as.character(record_id)) |> \n  left_join(places, by = \"record_id\") |> \n  mutate(city = case_match(city,\n                          \"Tuebingen\" ~ \"Tübingen\",\n                          \"İzmir\" ~ \"Izmir\",\n                          .default = city),\n         country = case_match(country,\n                              \"The Netherlands\" ~ \"Netherlands\",\n                              c(\"Turkiye\", \"Türkiye\") ~ \"Turkey\",\n                              c(\"US\", \"United States\", \"USA\") ~ \n                                \"United States of America\",\n                              \"UK\" ~ \"United Kingdom\",\n                              .default = country)\n         )\n```\n:::\n\n\n\n### First overview\n\nThe following code cells use the data imported so far to create some descriptive plots about the sample.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsex_lab <- primitive_bracket(\n  key  = key_range_manual(          # <− positions + labels\n    start = c(-7,0.1),\n    end = c(-0.1,7),# -6  and  +6  on the x-axis\n    name     = c(\"Males\", \"Females\")\n  ),\n  position = \"bottom\"         # draw it at the bottom of the panel\n)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nPlot_demo <- \ndata_devices_cleaned |>  \n  mutate(\n         age_group = \n           cut(age, \n               breaks = seq(15,70,5), \n               labels = c(\"18-20\", \"21-25\", \"26-30\", \"31-35\", \n                          \"36-40\", \"41-45\", \"46-50\", \"51-55\", \n                          \"56-60\", \"61-65\", \"66-70\"),\n               right = TRUE, ordered_result = TRUE),\n         ) |> \n  group_by(sex, age_group) |> \n  dplyr::summarize(n = n(), .groups = \"drop\") |> \n  mutate(n = ifelse(sex == \"Male\", -n, n)) |> \n  ggplot(aes(x= age_group, y = n, fill = sex)) + \n  geom_col() +\n  geom_hline(yintercept = 0) +\n  scale_y_continuous(breaks = seq(-6,6, by = 2), \n                     labels = c(6, 4, 2, 0, 2, 4, 6)) +\n  scale_fill_manual(values = c(Male = \"#2D6D66\", Female = \"#A23B54\")) + \n  guides(fill = \"none\", alpha = \"none\",\n         x = guide_axis_stack(\n           \"axis\", sex_lab\n         )) +\n  theme_minimal() +\n  coord_flip(ylim = c(-7, 7)) +\n  labs(x = \"Age (yrs)\", y = \"n\")\n\nPlot_demo\n```\n\n::: {.cell-output-display}\n![](Analysis_files/figure-html/sex and gender distribution-1.png){width=672}\n:::\n\n```{.r .cell-code}\nggsave(\"figures/Fig1_age.png\", \n       width = 6, height = 6, units = \"cm\", scale = 1.6)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlocation_stats <- \ndata_devices_cleaned |> \n  dplyr::summarise(\n    tz = n_distinct(UTC_dev),\n    country = n_distinct(country),\n    n = n()\n  ) |> \n  pivot_longer(\n    cols = everything()\n  ) |> \n  dplyr::mutate(name = case_match(name,\n                           \"country\" ~ \"Countries\",\n                           \"tz\" ~ \"Time zones\",\n                           \"n\" ~ \"Participants\"),\n         name = factor(name, levels = c(\"Time zones\", \"Countries\", \"Participants\"))\n         )\n\nP_stats <-\nlocation_stats |> \n  ggplot(aes(y = fct_rev(name), x = value, fill = name)) +\n  geom_col() +\n  geom_text(aes(label = value), color = \"white\", hjust = 1.2, fontface = 2, size = 3) +\n  theme_minimal() +\n  theme_sub_panel(grid = element_blank()) +\n  theme_sub_axis_bottom(text = element_blank()) + \n  theme_sub_plot(background = element_rect(fill = alpha(\"white\", 0.75))) +\n  labs(x = NULL, y = NULL) +\n  scale_fill_manual(values = c(`Time zones` = \"deepskyblue3\",\n                               Participants = \"red\",\n                               Countries = \"grey\")) +\n  guides(fill = \"none\")\n\nP_tz <-\n  data_devices_cleaned |> \n    group_by(UTC_dev) |> \n    dplyr::summarise(n = n()) |> \n    ggplot(aes(x=UTC_dev, y = n)) +\n    geom_vline(xintercept = 0, col = \"grey\") +\n    geom_hline(yintercept = 0, col = \"grey\") +\n    geom_col(fill = \"deepskyblue3\")+\n    geom_text(aes(label = n), fontface = 2, vjust = -0.2) +\n    theme_minimal() +\n    theme_sub_panel(grid.major.y = element_blank(),\n                    grid.minor = element_blank()) +\n    theme_sub_axis_left(text = element_blank()) +\n    scale_x_continuous(breaks = seq(-12, 12, 2)) +\n    labs(x = \"Deviation from UTC (h) on 22 Sep 2025\", y = \"n\") +\n    coord_cartesian(xlim = c(-11,11), ylim = c(NA, 30))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nworld <- ne_countries(scale = \"medium\", returnclass = \"sf\")\n    \ncountries_colors <- tibble(\n      country = data_devices_cleaned |> dplyr::count(country) |> pull(country),\n      color   = \"#0073C2FF\",\n      stringsAsFactors = FALSE\n    )\n    \nworld$color <- ifelse(\n      world$name %in% countries_colors$country,\n      countries_colors$country[match(world$name, countries_colors$country)],\n      NA\n    )\n    \nlocation_info <- tibble(\n      country  = data_devices_cleaned |> pull(country),\n      lat      = data_devices_cleaned |> pull(latitude),\n      lon      = data_devices_cleaned |> pull(longitude),\n      color    = \"#0073C2FF\",\n      stringsAsFactors = FALSE\n    ) |> \n  mutate(lat2 = plyr::round_any(lat, 12), \n         lon2 = plyr::round_any(lon, 12)) |> \n  dplyr::summarize(\n    .by = c(lat2, lon2),\n    lat = mean(lat),\n    lon = mean(lon),\n    color = unique(color),\n    n = n()\n  )\n    \nlocations <- st_as_sf(location_info, coords = c(\"lon\", \"lat\"), crs = 4326)\nworld_proj     <- st_transform(world,    crs = \"+proj=eqc\")\nlocations_proj <- st_transform(locations, crs = \"+proj=eqc\")\nbb <- st_bbox(world_proj)\ntz <- sf::st_read(\"data/tz_now/combined-shapefile-with-oceans-now.shp\")  # or .gpkg / .geojson\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nReading layer `combined-shapefile-with-oceans-now' from data source \n  `/Users/zauner/Documents/Arbeit/12-TUM/2025_ADayInDaylight_Data/data/tz_now/combined-shapefile-with-oceans-now.shp' \n  using driver `ESRI Shapefile'\nSimple feature collection with 92 features and 1 field\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: -180 ymin: -90 xmax: 180 ymax: 90\nGeodetic CRS:  WGS 84\n```\n\n\n:::\n\n```{.r .cell-code}\ntz_lines <- sf::st_boundary(tz)\n\nP_map <-\n  ggplot() +\n  geom_sf(\n    data = world_proj,\n    # aes(fill = color),\n    fill = \"grey\",\n    color = NA,\n    size = 0.25,\n    alpha = 0.5,\n    show.legend = FALSE\n  ) +\n  geom_sf(data = tz_lines,\n          colour = \"deepskyblue3\",\n          linewidth = 0.15) +\n  geom_sf(\n    data = locations_proj,\n    aes(size = n),\n    fill = \"red\",\n    alpha = 0.9,\n    shape = 21,\n    color = \"#0073C2FF\",\n    stroke = 0.2\n  ) +\n  geom_sf_text(\n    data = locations_proj,\n    aes(label = n),\n    size = 1.5,\n    fontface = 2,\n    color = \"white\",\n    alpha = 0.75\n  ) +\n  scale_fill_manual(values = rep(\"#0073C2FF\", 15)) +\n  scale_size_continuous(range = c(2, 5)) +\n  theme_minimal() +\n  theme(legend.position = \"none\") +\n  labs(x = NULL, y = NULL) +\n  coord_sf(expand = FALSE)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nP_map_patch <- \n(P_map + inset_element(P_stats, 0.05, 0.05, 0.25, 0.25)) / P_tz + plot_layout(heights = c(4.4,1))\n\nggsave(\"figures/Fig2_location.pdf\",P_map_patch,\n       width = 15, height = 10, units = \"cm\", scale = 1.6)\nggsave(\"figures/Fig2_location.png\",\n       P_map_patch,\n       width = 14, height = 9.5, units = \"cm\", scale = 1.6)\n```\n:::\n\n\n\n### Import wearable data\n\nNext, we import the light data. There are two devices in use: `ActLumus` and `ActTrust` we need to import them separately, as they are using different import functions. `device_id` with four number indicate the `ActLumus` devices, whereas with seven numbers the `ActTrust`. We add a column to the data indicating the Type of device in use. We also make sure that the spelling equals the `supported_devices()` list from `LightLogR`. Then we construct filename paths for all files.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nc(\"ActLumus\", \"ActTrust\") %in% supported_devices()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] TRUE TRUE\n```\n\n\n:::\n\n```{.r .cell-code}\ndata_devices_cleaned <- \ndata_devices_cleaned |> \n  dplyr::mutate(device_type = \n           case_when(\n              str_length(device_id) == 4 ~ \"ActLumus\",\n              str_length(device_id) == 7 ~ \"ActTrust\"\n           ),\n         file_path = glue(\"data/lightloggers/{device_id}.txt\")\n         )\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_devices_cleaned <- \ndata_devices_cleaned |> \n  dplyr::mutate(\n    data = purrr::pmap(list(x = device_type, y = file_path, z = tz_identifier), \n                       \\(x, y, z) {\n                         import_Dataset(device = x, filename = y, tz = z,\n                                        silent = TRUE)\n                       }\n    )\n  )\n```\n:::\n\n\n\nWe end with one dataset per row entry. As the two `ActTrust` files do not contain a melanopic EDI column, we will use the photopic illuminance column `LIGHT` towards that end. As there are only two participants with this shortcoming, it will not influence results overduly.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_devices_cleaned <- \ndata_devices_cleaned |> \n  dplyr::mutate(\n    data = purrr::map2(device_type, data, \n                       \\(x,y) {\n                         if(x == \"ActTrust\") {\n                           y |> dplyr::rename(MEDI = LIGHT)\n                         }\n                         else y\n                         }\n                       )\n  )\n```\n:::\n\n\n\nFurther, the dataset in Malaysia had a device malfunction on 22 September and only worked from the 23 September onwards. As there are minimal differences between dates and very few datasets in that region, we will not dismiss that dataset but rather shift data by one day. We need to shift the data by another 8 hours backwards, as that dataset was stored in UTC time (for some reason).\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_devices_cleaned <- \ndata_devices_cleaned |> \n  dplyr::mutate(\n    data = purrr::map2(record_id, data, \n                       \\(x,y) {\n                         if(x == \"25\") {\n                           y |> dplyr::mutate(\n                             Datetime = Datetime - ddays(1) - dhours(8)\n                             )\n                         }\n                         else y\n                         }\n                       )\n  )\n```\n:::\n\n\n\n## Light data\n\n### Cleaning light data\n\nIn this section we will prepare the light data through the following steps:\n\n- resampling data to 5 minute intervals\n- filling in missing data with explicit gaps\n- removing data that does not fall between `2025-09-21 10:00:00 UTC` and `2025-09-23 12:00:00 UTC`, which contains all times where 22 September occurs *somewhere* on the planet\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_devices <-\ndata_devices_cleaned |> \n  dplyr::mutate(\n    data = purrr::map(data, \n                       \\(x) {\n                           x |> \n                           aggregate_Datetime(\"5 mins\") |> #resample to 5 mins\n                           gap_handler(full.days = TRUE) |> #put in explicit gaps\n                           filter_Datetime(start = \"2025-09-21 10:00:00\",\n                                           end = \"2025-09-23 12:00:00\",\n                                           tz = \"UTC\") #cut out a section of data\n                         }\n                       )\n  )\n```\n:::\n\n\n\nNext, we add a secondary `Datetime` column that runs on UTC time.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_devices <-\ndata_devices |> \n  dplyr::mutate(\n    data = purrr::map(data, \n                       \\(x) {\n                           x |> \n                           dplyr::mutate(Datetime_UTC = Datetime |> force_tz(\"UTC\"))\n                         }\n                       )\n  )\n```\n:::\n\n\n\n### Visualizing light data\n\nNow we can visualize the whole dataset - first by combining all datasets.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstart_dt <- as.POSIXct(\"2025-09-21 10:00:00\", tz = \"UTC\")\nstart_dt2 <- as.POSIXct(\"2025-09-22 00:00:00\", tz = \"UTC\")\nend_dt <- as.POSIXct(\"2025-09-23 12:00:00\", tz = \"UTC\")\nend_dt2 <- as.POSIXct(\"2025-09-23 00:00:00\", tz = \"UTC\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlight_data <- \n  join_datasets(!!!data_devices$data) |> \n  mutate(Datetime = Datetime |> with_tz(\"UTC\"))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlight_data |> \n  aggregate_Datetime(\"1hour\") |> \n  gg_days(facetting = FALSE, \n          group = Id, \n          geom = \"ribbon\",\n          lwd = 0.25,\n          fill = \"skyblue3\",\n          color = \"skyblue4\",\n          alpha = 0.1,\n          y.axis.label = \"UTC Time\"\n          ) +\n  geom_vline(xintercept = c(start_dt, end_dt), color = \"red\")\n```\n\n::: {.cell-output-display}\n![](Analysis_files/figure-html/visualize light data-1.png){width=672}\n:::\n\n```{.r .cell-code}\nlight_data |> \n  aggregate_Datetime(\"1hour\") |> \n  gg_days(Datetime_UTC,\n          geom = \"ribbon\",\n          facetting = FALSE,\n          fill = \"skyblue3\",\n          color = \"skyblue4\",\n          alpha = 0.1,\n          group = Id, \n          lwd = 0.25,\n          y.axis.label = \"Local Time\"\n          ) +\n  geom_vline(xintercept = c(start_dt2, end_dt2), color = \"red\")\n```\n\n::: {.cell-output-display}\n![](Analysis_files/figure-html/visualize light data-2.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlight_data |> \n  aggregate_Datetime(\"1hour\") |> \n  gg_days(Datetime_UTC,\n          facetting = FALSE, \n          group = Id, \n          lwd = 0.25,\n          y.axis.label = \"UTC Time\"\n          ) +\n  geom_vline(xintercept = c(start_dt2, end_dt2), color = \"red\")\n```\n\n::: {.cell-output-display}\n![](Analysis_files/figure-html/animate light data-1.png){width=672}\n:::\n\n```{.r .cell-code}\nboundaries <- tibble(\n  start = c(start_dt, start_dt2),\n  end = c(end_dt, end_dt2),\n  name = c(\"UTC Time\", \"Local Time\")\n)\n\np <- \nlight_data |> \n  aggregate_Datetime(\"2 hours\") |>\n  select(Id, Datetime, Datetime_UTC, MEDI) |> \n  pivot_longer(-c(Id, MEDI)) |> \n  mutate(name = case_match(name,\n                           \"Datetime\" ~ \"UTC Time\",\n                           \"Datetime_UTC\" ~ \"Local Time\")) |> \n  dplyr::mutate(name = factor(name)) |> \n    gg_days(value,\n            geom = \"ribbon\",\n            fill = \"skyblue3\",\n            alpha = 0.4,\n            color = \"black\",\n          facetting = FALSE, \n          group = Id, \n          lwd = 0.1,\n          x.axis.label = \"{next_state} {if(transitioning) '(transitioning)' else ''}\",\n          y.axis.label = \"Melanopic EDI (lx)\",\n          x.axis.breaks = \\(x) Datetime_breaks(x, by = \"6 hours\", shift = 0),\n          x.axis.format = \"%H:%M\"\n    )  + \n  geom_vline(data = boundaries, aes(xintercept=start), col = \"red\", lty = 2, inherit.aes = FALSE)+\n  geom_vline(data = boundaries, aes(xintercept=end), col = \"red\", lty = 2, inherit.aes = FALSE)+\n  geom_segment(data = boundaries, \n               aes(y = 25000, x = start, xend = end), \n               arrow = arrow(length = unit(0.1, \"inches\"), ends = \"both\"), col = \"red\",  \n               inherit.aes = FALSE)+\n  annotate(geom = \"text\", y = 25000, x = mean(c(start_dt2, end_dt2)), \n           vjust = -0.4, label = \"Global 22 September\", col = \"red\") +\n  transition_states(\n    name, \n    transition_length = 1,\n    state_length = 1\n  )\n\nif(interactive()){\nanimation <- \nanimate(p, width = 1200, height = 700, res = 150)\n\nanimation\n\nanim_save(\"figures/patterns.gif\", animation)\n}\n```\n:::\n\n\n\n## Events\n\n### Cleaning events\n\nIn this section we deal with with the activity logs - first by filtering them out of the dataset, and selecting the relevant aspects.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nevents <- \ndata |> \n  filter(redcap_repeat_instrument == \"log_a_new_activity\") |> \n  select(record_id,\n         type.factor, \n         social_context.factor,\n         wear_activity.factor,\n         nonwear_activity.factor,\n         nighttime.factor,\n         setting_level01.factor, \n         setting_level02_indoors.factor,\n         setting_level02_indoors_home.factor,\n         setting_level02_indoors_workingspace.factor,\n         setting_level02_indoors_healthfacility.factor,\n         setting_level02_indoors_learningfacility.factor,\n         setting_level02_indoors_leisurespace.factor,\n         setting_level02_indoors_retailfacility.factor,\n         setting_level02_mixed.factor,\n         setting_level02_outdoors.factor,\n         lighting_scenario_daylight___1.factor,\n         lighting_scenario_daylight___2.factor,\n         lighting_scenario_daylight___3.factor,\n         lighting_scenario_daylight___4.factor,\n         lighting_scenario_3___1.factor,\n         lighting_scenario_3___2.factor,\n         lighting_scenario_3___3.factor,\n         lighting_scenario_2___1.factor,\n         lighting_scenario_2___2.factor,\n         lighting_scenario_2___3.factor,\n         lighting_scenario_2___4.factor,\n         autonomy.factor,\n         notes, \n         startdate, enddate\n         )\n\n#adding labels to the factors\nlabel(events$type.factor) = \"Wear type: Are you wearing the light logger at the moment?\"\nlabel(events$social_context.factor) = \"Are you alone or with others?\"\nlabel(events$wear_activity.factor) = \"Wear activity \"\nlabel(events$nonwear_activity.factor) = \"Non-wear activity\"\nlabel(events$nighttime.factor) = \"Where was the light logger when you were asleep?\"\nlabel(events$setting_level01.factor) = \"Select the setting\"\nlabel(events$setting_level02_indoors.factor) = \"Indoors setting\"\nlabel(events$setting_level02_indoors_home.factor) = \"Indoors setting (home)\"\nlabel(events$setting_level02_indoors_workingspace.factor) = \"Indoors setting (working space)\"\nlabel(events$setting_level02_indoors_learningfacility.factor) = \"Indoors setting (learning facility)\"\nlabel(events$setting_level02_indoors_retailfacility.factor) = \"Indoors setting (retail facility)\"\nlabel(events$setting_level02_indoors_healthfacility.factor) = \"Indoors setting (health facility)\"\nlabel(events$setting_level02_indoors_leisurespace.factor) = \"Indoors setting (leisure space)\"\nlabel(events$setting_level02_outdoors.factor) = \"Outdoors setting\"\nlabel(events$setting_level02_mixed.factor) = \"Indoors-outdoors setting\"\nlabel(events$lighting_scenario_daylight___1.factor) = \"Select lighting setting (daylight) (choice=Outdoors (direct sunlight))\"\nlabel(events$lighting_scenario_daylight___2.factor) = \"Select lighting setting (daylight) (choice=Outdoors (in shade / cloudy))\"\nlabel(events$lighting_scenario_daylight___3.factor) = \"Select lighting setting (daylight) (choice=Indoors (near window / exposed to daylight))\"\nlabel(events$lighting_scenario_daylight___4.factor) = \"Select lighting setting (daylight) (choice=Indoors (away from window))\"\nlabel(events$lighting_scenario_3___1.factor) = \"Select lighting setting (electric light) (choice=Lights are switched on)\"\nlabel(events$lighting_scenario_3___2.factor) = \"Select lighting setting (electric light) (choice=Low-light or dimmed lights)\"\nlabel(events$lighting_scenario_3___3.factor) = \"Select lighting setting (electric light) (choice=Completed darkness)\"\nlabel(events$lighting_scenario_2___1.factor) = \"Select lighting setting (screen use) (choice=Smartphone)\"\nlabel(events$lighting_scenario_2___2.factor) = \"Select lighting setting (screen use) (choice=Tablet)\"\nlabel(events$lighting_scenario_2___3.factor) = \"Select lighting setting (screen use) (choice=Computer)\"\nlabel(events$lighting_scenario_2___4.factor) = \"Select lighting setting (screen use) (choice=Television)\"\nlabel(events$autonomy.factor) = \"Were the lighting conditions in this setting self-selected (i.e., you had control over lighting intensity, spectrum, or exposure)?\"\n```\n:::\n\n\n\nNext, we condense columns that can be expressed as one. We also lose the `.factor` extension, as now all doubles are removed. Finally, we simplify entries.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nevents <- \nevents |> \n  rename_with(\\(x) x |> str_remove(\".factor\")) |> #remove .factor extension\n  dplyr::mutate(\n    type = type |> fct_relabel(\\(x) str_remove(x, \"-time| time| \\\\(not wearing light logger\\\\)\")),\n    across(c(wear_activity, setting_level01),\n           \\(x) x |> fct_relabel(\\(y) str_remove(y, \" \\\\(.*\\\\)\"))\n           ),\n    nonwear_activity = \n      nonwear_activity |> fct_recode(\n        \"Dark mobile\" = \"Left in a bag, or other mobile dark place\",\n        \"Dark stationary\" = \"Left in a drawer or cabinet, or other stationary dark place\",\n        \"Stationary\" = \"Left on a table or other surface with varying light exposure\"\n      ),\n    nighttime = \n      nighttime |> fct_recode(\n        \"Upward\" = \"Facing upward on bedside table\",\n        \"Downward\" = \"Facing downward on bedside table\"\n      ),\n    across(c(setting_level02_indoors, setting_level02_outdoors),\n           \\(x) x |> fct_recode(\n        \"Leisure\" = \"Leisure space (sports, recreation, entertainment)\",\n        \"Commercial\" = \"Retail, food or services facility\",\n        \"Workplace\" = \"Working space\",\n        \"Education\" = \"Learning facility\",\n        \"Healthcare\" = \"Health facility\"\n           )\n        ),\n    setting_level01 = \n      setting_level01 |> fct_recode(\n        \"Mixed\" = \"Indoor-outdoor setting\"\n      ),\n    autonomy =\n      autonomy |> fct_recode(\n        Yes = \"Yes, fully self-selected (e.g., adjusting lights at home or in a private office, moving to shaded area)\",\n        Partly = \"Partly self-selected (e.g., some control such as opening blinds or switching a desk lamp, but not over main lighting)\",\n        No = \"Not self-selected (e.g., public transport, shared office, classroom, hospital, airplane, etc.)\",\n        NULL = \"Not applicable\"\n      )\n  ) |> \n  dplyr::rename(setting_light = setting_level01)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nevents <- \nevents |>\n  dplyr::mutate(\n    scenario_daylight =\n      case_when(\n        (lighting_scenario_daylight___1 == \"Checked\") & \n          (setting_light %in% c(\"Outdoors\", \"Mixed\")) ~ \"Direct sunlight\",\n        (lighting_scenario_daylight___2 == \"Checked\") &\n          (setting_light %in% c(\"Outdoors\", \"Mixed\")) ~ \"Shade / cloudy\",\n        (lighting_scenario_daylight___3 == \"Checked\") &\n          (setting_light %in% c(\"Indoors\", \"Mixed\")) ~ \"Near a window\",\n        (lighting_scenario_daylight___4 == \"Checked\") &\n          (setting_light %in% c(\"Indoors\", \"Mixed\")) ~ \"Away from window\"\n      ),\n    scenario_electric =\n      case_when(\n        lighting_scenario_3___3 == \"Checked\" ~ \"Lights off\",\n        lighting_scenario_3___2 == \"Checked\" ~ \"Dim light\",\n        lighting_scenario_3___1 == \"Checked\" ~ \"Lights on\",\n      ),\n    across(starts_with(\"lighting_scenario_2___\"),\n           \\(x) ifelse(x == \"Checked\", TRUE, FALSE)),\n  ) |> \n  dplyr::rename(screen_phone = lighting_scenario_2___1,\n                screen_tablet = lighting_scenario_2___2,\n                screen_pc = lighting_scenario_2___3,\n                screen_tv = lighting_scenario_2___4\n                ) |> \n  select(-starts_with(\"lighting_scenario\")) |> \n  dplyr::mutate(\n    wear_activity = case_when(type == \"Wear\" ~ wear_activity, .default = NA),\n    nonwear_activity = case_when(type == \"Non-wear\" ~ nonwear_activity, .default = NA),\n    nighttime = case_when(type == \"Bedtime\" ~ nighttime, .default = NA),\n    setting_level02_mixed = case_when(setting_light == \"Mixed\" ~ setting_level02_mixed, .default = NA),\n    setting_level02_indoors = case_when(setting_light == \"Indoors\" ~ setting_level02_indoors, .default = NA),\n    setting_level02_outdoors = case_when(setting_light == \"Outdoors\" ~ setting_level02_outdoors, .default = NA),\n    setting_level02_indoors_leisurespace = case_when(setting_level02_indoors == \"Leisure\" ~ setting_level02_indoors_leisurespace, .default = NA),\n    setting_level02_indoors_workingspace = case_when(setting_level02_indoors == \"Workplace\" ~ setting_level02_indoors_workingspace, .default = NA),\n  ) |> \n  unite(\"type.detail\", c(wear_activity, nonwear_activity, nighttime), na.rm = TRUE,\n        remove = FALSE) |> \n  unite(\"setting_location\", \n        c(setting_level02_indoors, setting_level02_outdoors, setting_level02_mixed), \n        na.rm = TRUE, remove = FALSE) |> \n  unite(\"setting_specific\", \n        starts_with(\"setting_level02_indoors_\"), \n        na.rm = TRUE, remove = FALSE) |> \n  dplyr::rename_with(\\(x) x |> str_remove(\"_level02\")) |> \n  relocate(scenario_daylight, scenario_electric, .before = screen_phone) |> \n  relocate(startdate, .before = 1) |> \n  select(-enddate) |> \n  dplyr::mutate(\n    across(c(setting_location, setting_specific, type.detail),\n           \\(x) fct_recode(x, NULL = \"\"))\n  )\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\npart_data <- data_devices |> select(-data) |> mutate(record_id = as.character(record_id))\n\nevents_complete <- \nevents |> \n  dplyr::mutate(record_id = as.character(record_id)) |> \n  left_join(part_data, by = \"record_id\") |> \n  drop_na(tz_identifier)\n\nlabel(events_complete$record_id) = \"Record ID\"\n\nevents_complete <- \nevents_complete |> \n  dplyr::mutate(\n    Datetime = as.POSIXct(startdate, tz = \"UTC\"),\n    UTC_dt = force_tzs(Datetime, tz_identifier),\n    .before = 1) |> \n  select(-startdate)\n```\n:::\n\n\n\n### Summaries\n\nIn this section we will calculate some summary statistics regarding events\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nevents_complete <- \nevents_complete |> \n  dplyr::mutate(status.duration = c(diff(Datetime), na_dbl), \n                .by = record_id,\n                .after = Datetime) |> \n  filter(!record_id %in% c(\"31\", \"30\", \"44\"))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlabel(events_complete$status.duration) = \"Time between log entries\"\nlabel(events_complete$type.detail) = \"Wear/Non-wear context\"\nlabel(events_complete$setting_location) = \"General setting\"\nlabel(events_complete$setting_specific) = \"Specific indoor setting\"\nlabel(events_complete$scenario_daylight) = \"Daylight conditions\"\nlabel(events_complete$scenario_electric) = \"Electric lighting conditions\"\nlabel(events_complete$screen_phone) = \"Phone use\"\nlabel(events_complete$screen_tablet) = \"Tablet use\"\nlabel(events_complete$screen_pc) = \"Computer use\"\nlabel(events_complete$screen_tv) = \"Television use\"\nlabel(events_complete$sex) = \"Sex\"\nlabel(events_complete$city) = \"City\"\nlabel(events_complete$country) = \"Country\"\nlabel(events_complete$latitude) = \"Latitude\"\nlabel(events_complete$longitude) = \"Longitude\"\nlabel(events_complete$tz_identifier) = \"Time zone identifier\"\nlabel(events_complete$UTC_dev) = \"Time zone deviation from UTC\"\nlabel(events_complete$device_type) = \"Used device\"\nlabel(events_complete$file_path) = \"File path\"\nlabel(events_complete$setting_indoors) = \"Indoor settings\"\nlabel(events_complete$setting_outdoors) = \"Outdoor settings\"\nlabel(events_complete$setting_mixed) = \"Outdoor-Indoor mixed settings\"\nlabel(events_complete$wear_activity) = \"Activity\"\nlabel(events_complete$nonwear_activity) = \"Non-wear wearable position\"\nlabel(events_complete$nighttime) = \"Nightstand wearable measurement direction\"\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nevent_summary1 <- \nevents_complete |> \n  dplyr::summarize(.by = record_id,\n            n = n(),\n            mean.duration = mean(status.duration, na.rm = TRUE),\n            covered.timespan = last(Datetime) - first(Datetime)\n  )\nlabel(event_summary1$n) = \"Log entries\"\nlabel(event_summary1$mean.duration) = \"Mean duration between log entries\"\nunits(event_summary1$mean.duration) = \"hours\"\nlabel(event_summary1$covered.timespan) = \"Total time span of log entries\"\n\nevent_summary1.tbl <- \nevent_summary1 |> \n  tbl_summary(include = -record_id,\n              statistic = list(all_continuous() ~ \"{mean} ({min}-{max})\")\n              ) |> \n  modify_caption(\"**Activity logging (by-participant level)**\")\n\nevent_summary1.tbl\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"mtqjhgocwk\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#mtqjhgocwk table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#mtqjhgocwk thead, #mtqjhgocwk tbody, #mtqjhgocwk tfoot, #mtqjhgocwk tr, #mtqjhgocwk td, #mtqjhgocwk th {\n  border-style: none;\n}\n\n#mtqjhgocwk p {\n  margin: 0;\n  padding: 0;\n}\n\n#mtqjhgocwk .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#mtqjhgocwk .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#mtqjhgocwk .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#mtqjhgocwk .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#mtqjhgocwk .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#mtqjhgocwk .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#mtqjhgocwk .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#mtqjhgocwk .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#mtqjhgocwk .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#mtqjhgocwk .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#mtqjhgocwk .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#mtqjhgocwk .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#mtqjhgocwk .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#mtqjhgocwk .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#mtqjhgocwk .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#mtqjhgocwk .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#mtqjhgocwk .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#mtqjhgocwk .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#mtqjhgocwk .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#mtqjhgocwk .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#mtqjhgocwk .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#mtqjhgocwk .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#mtqjhgocwk .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#mtqjhgocwk .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#mtqjhgocwk .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#mtqjhgocwk .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#mtqjhgocwk .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#mtqjhgocwk .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#mtqjhgocwk .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#mtqjhgocwk .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#mtqjhgocwk .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#mtqjhgocwk .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#mtqjhgocwk .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#mtqjhgocwk .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#mtqjhgocwk .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#mtqjhgocwk .gt_left {\n  text-align: left;\n}\n\n#mtqjhgocwk .gt_center {\n  text-align: center;\n}\n\n#mtqjhgocwk .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#mtqjhgocwk .gt_font_normal {\n  font-weight: normal;\n}\n\n#mtqjhgocwk .gt_font_bold {\n  font-weight: bold;\n}\n\n#mtqjhgocwk .gt_font_italic {\n  font-style: italic;\n}\n\n#mtqjhgocwk .gt_super {\n  font-size: 65%;\n}\n\n#mtqjhgocwk .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#mtqjhgocwk .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#mtqjhgocwk .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#mtqjhgocwk .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#mtqjhgocwk .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#mtqjhgocwk .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#mtqjhgocwk .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#mtqjhgocwk .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#mtqjhgocwk div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <caption><span data-qmd-base64=\"KipBY3Rpdml0eSBsb2dnaW5nIChieS1wYXJ0aWNpcGFudCBsZXZlbCkqKg==\"><span class='gt_from_md'><strong>Activity logging (by-participant level)</strong></span></span></caption>\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"label\"><span data-qmd-base64=\"KipDaGFyYWN0ZXJpc3RpYyoq\"><span class='gt_from_md'><strong>Characteristic</strong></span></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"stat_0\"><span data-qmd-base64=\"KipOID0gNDcqKg==\"><span class='gt_from_md'><strong>N = 47</strong></span></span><span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;\"><sup>1</sup></span></th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">Log entries</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">38 (9-80)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">Mean duration between log entries</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">1.69 hours (0.53 hours-3.92 hours)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">Total time span of log entries</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">2.09 days (1.14 days-4.13 days)</td></tr>\n  </tbody>\n  \n  <tfoot class=\"gt_footnotes\">\n    <tr>\n      <td class=\"gt_footnote\" colspan=\"2\"><span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;\"><sup>1</sup></span> <span data-qmd-base64=\"TWVhbiAoTWluLU1heCk=\"><span class='gt_from_md'>Mean (Min-Max)</span></span></td>\n    </tr>\n  </tfoot>\n</table>\n</div>\n```\n\n:::\n\n```{.r .cell-code}\ngtsave(event_summary1.tbl |> as_gt(), \"tables/table1.png\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nfile:////var/folders/9p/326_k3kx43qbn_cyl1rqfhb00000gn/T//RtmpMgDt2v/filed2021d954ab2.html screenshot completed\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nevent_tbl_setting <- \nevents_complete |> \n  select(setting_indoors, setting_outdoors, setting_mixed\n         ) |> \n  tbl_summary(missing = \"no\"\n  )\n\nevent_tbl_setting\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"yoetzvpsej\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#yoetzvpsej table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#yoetzvpsej thead, #yoetzvpsej tbody, #yoetzvpsej tfoot, #yoetzvpsej tr, #yoetzvpsej td, #yoetzvpsej th {\n  border-style: none;\n}\n\n#yoetzvpsej p {\n  margin: 0;\n  padding: 0;\n}\n\n#yoetzvpsej .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#yoetzvpsej .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#yoetzvpsej .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#yoetzvpsej .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#yoetzvpsej .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#yoetzvpsej .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#yoetzvpsej .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#yoetzvpsej .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#yoetzvpsej .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#yoetzvpsej .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#yoetzvpsej .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#yoetzvpsej .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#yoetzvpsej .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#yoetzvpsej .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#yoetzvpsej .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#yoetzvpsej .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#yoetzvpsej .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#yoetzvpsej .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#yoetzvpsej .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#yoetzvpsej .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#yoetzvpsej .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#yoetzvpsej .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#yoetzvpsej .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#yoetzvpsej .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#yoetzvpsej .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#yoetzvpsej .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#yoetzvpsej .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#yoetzvpsej .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#yoetzvpsej .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#yoetzvpsej .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#yoetzvpsej .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#yoetzvpsej .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#yoetzvpsej .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#yoetzvpsej .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#yoetzvpsej .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#yoetzvpsej .gt_left {\n  text-align: left;\n}\n\n#yoetzvpsej .gt_center {\n  text-align: center;\n}\n\n#yoetzvpsej .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#yoetzvpsej .gt_font_normal {\n  font-weight: normal;\n}\n\n#yoetzvpsej .gt_font_bold {\n  font-weight: bold;\n}\n\n#yoetzvpsej .gt_font_italic {\n  font-style: italic;\n}\n\n#yoetzvpsej .gt_super {\n  font-size: 65%;\n}\n\n#yoetzvpsej .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#yoetzvpsej .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#yoetzvpsej .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#yoetzvpsej .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#yoetzvpsej .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#yoetzvpsej .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#yoetzvpsej .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#yoetzvpsej .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#yoetzvpsej div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"label\"><span data-qmd-base64=\"KipDaGFyYWN0ZXJpc3RpYyoq\"><span class='gt_from_md'><strong>Characteristic</strong></span></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"stat_0\"><span data-qmd-base64=\"KipOID0gMSw3NjMqKg==\"><span class='gt_from_md'><strong>N = 1,763</strong></span></span><span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;\"><sup>1</sup></span></th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">Indoor settings</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\"><br /></td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Home</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">661 (70%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Workplace</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">126 (13%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Education</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">17 (1.8%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Commercial</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">84 (8.9%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Healthcare</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">3 (0.3%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Leisure</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">23 (2.4%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Other</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">27 (2.9%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">Outdoor settings</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\"><br /></td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Home</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">51 (15%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Workplace</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">24 (6.8%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Education</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">8 (2.3%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Commercial</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">19 (5.4%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Healthcare</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">0 (0%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Leisure</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">83 (24%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Other</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">166 (47%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">Outdoor-Indoor mixed settings</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\"><br /></td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Covered patio or terrace</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">20 (8.1%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Semi-open corridor/gallery</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">11 (4.5%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Balcony</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">3 (1.2%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Veranda</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">5 (2.0%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Atrium</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">1 (0.4%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Transportation (car/taxi)</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">138 (56%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Transportation (bus or commuter/regional rail)</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">31 (13%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Transportation (long-distance train)</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">6 (2.4%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Transportation (underground, subway)</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">6 (2.4%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Transportation (airplane)</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">6 (2.4%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Transportation (bike)</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">5 (2.0%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Transportation (ferry)</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">1 (0.4%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Other</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">14 (5.7%)</td></tr>\n  </tbody>\n  \n  <tfoot class=\"gt_footnotes\">\n    <tr>\n      <td class=\"gt_footnote\" colspan=\"2\"><span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;\"><sup>1</sup></span> <span data-qmd-base64=\"biAoJSk=\"><span class='gt_from_md'>n (%)</span></span></td>\n    </tr>\n  </tfoot>\n</table>\n</div>\n```\n\n:::\n\n```{.r .cell-code}\ngtsave(event_tbl_setting |> as_gt(), \"tables/table2.png\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nfile:////var/folders/9p/326_k3kx43qbn_cyl1rqfhb00000gn/T//RtmpMgDt2v/filed2024b0f9c32.html screenshot completed\n```\n\n\n:::\n\n```{.r .cell-code}\nevent_tbl_indoors <- \nevents_complete |> \n  select(setting_specific\n         ) |> \n  tbl_summary(missing = \"no\"\n  )\n\nevent_tbl_indoors\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"cvvwglmpxs\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#cvvwglmpxs table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#cvvwglmpxs thead, #cvvwglmpxs tbody, #cvvwglmpxs tfoot, #cvvwglmpxs tr, #cvvwglmpxs td, #cvvwglmpxs th {\n  border-style: none;\n}\n\n#cvvwglmpxs p {\n  margin: 0;\n  padding: 0;\n}\n\n#cvvwglmpxs .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#cvvwglmpxs .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#cvvwglmpxs .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#cvvwglmpxs .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#cvvwglmpxs .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#cvvwglmpxs .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#cvvwglmpxs .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#cvvwglmpxs .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#cvvwglmpxs .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#cvvwglmpxs .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#cvvwglmpxs .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#cvvwglmpxs .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#cvvwglmpxs .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#cvvwglmpxs .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#cvvwglmpxs .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#cvvwglmpxs .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#cvvwglmpxs .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#cvvwglmpxs .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#cvvwglmpxs .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#cvvwglmpxs .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#cvvwglmpxs .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#cvvwglmpxs .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#cvvwglmpxs .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#cvvwglmpxs .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#cvvwglmpxs .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#cvvwglmpxs .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#cvvwglmpxs .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#cvvwglmpxs .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#cvvwglmpxs .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#cvvwglmpxs .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#cvvwglmpxs .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#cvvwglmpxs .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#cvvwglmpxs .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#cvvwglmpxs .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#cvvwglmpxs .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#cvvwglmpxs .gt_left {\n  text-align: left;\n}\n\n#cvvwglmpxs .gt_center {\n  text-align: center;\n}\n\n#cvvwglmpxs .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#cvvwglmpxs .gt_font_normal {\n  font-weight: normal;\n}\n\n#cvvwglmpxs .gt_font_bold {\n  font-weight: bold;\n}\n\n#cvvwglmpxs .gt_font_italic {\n  font-style: italic;\n}\n\n#cvvwglmpxs .gt_super {\n  font-size: 65%;\n}\n\n#cvvwglmpxs .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#cvvwglmpxs .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#cvvwglmpxs .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#cvvwglmpxs .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#cvvwglmpxs .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#cvvwglmpxs .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#cvvwglmpxs .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#cvvwglmpxs .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#cvvwglmpxs div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"label\"><span data-qmd-base64=\"KipDaGFyYWN0ZXJpc3RpYyoq\"><span class='gt_from_md'><strong>Characteristic</strong></span></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"stat_0\"><span data-qmd-base64=\"KipOID0gMSw3NjMqKg==\"><span class='gt_from_md'><strong>N = 1,763</strong></span></span><span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;\"><sup>1</sup></span></th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">Specific indoor setting</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\"><br /></td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Bathroom</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">86 (9.6%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Bedroom</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">114 (13%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Break/lounge area</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">6 (0.7%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Classroom</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">4 (0.4%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Conference/meeting room</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">18 (2.0%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Convenience store/supermarkt</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">23 (2.6%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Corridor</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">10 (1.1%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Dentist</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">1 (0.1%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Drug store</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">1 (0.1%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Home office</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">85 (9.5%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Kitchen</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">100 (11%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Laboratory</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">2 (0.2%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Lecture hall</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">2 (0.2%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Library</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">2 (0.2%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Living room</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">213 (24%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Office supply store</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">1 (0.1%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Open-plan office area</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">16 (1.8%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Other</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">80 (8.9%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Parking garage</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">10 (1.1%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Personal workspace/desk</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">72 (8.0%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Restaurant/cafeteria/bakery</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">32 (3.6%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Shopping mall</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">16 (1.8%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Studio</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">1 (0.1%)</td></tr>\n  </tbody>\n  \n  <tfoot class=\"gt_footnotes\">\n    <tr>\n      <td class=\"gt_footnote\" colspan=\"2\"><span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;\"><sup>1</sup></span> <span data-qmd-base64=\"biAoJSk=\"><span class='gt_from_md'>n (%)</span></span></td>\n    </tr>\n  </tfoot>\n</table>\n</div>\n```\n\n:::\n\n```{.r .cell-code}\ngtsave(event_tbl_indoors |> as_gt(), \"tables/table3.png\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nfile:////var/folders/9p/326_k3kx43qbn_cyl1rqfhb00000gn/T//RtmpMgDt2v/filed2026dd7bd1d.html screenshot completed\n```\n\n\n:::\n\n```{.r .cell-code}\nevent_tbl_wear <- \nevents_complete |> \n  select(type, wear_activity, nonwear_activity, nighttime\n         ) |> \n  tbl_summary(\n    missing = \"no\"\n  )\n\nevent_tbl_wear\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"aejuoezzab\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#aejuoezzab table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#aejuoezzab thead, #aejuoezzab tbody, #aejuoezzab tfoot, #aejuoezzab tr, #aejuoezzab td, #aejuoezzab th {\n  border-style: none;\n}\n\n#aejuoezzab p {\n  margin: 0;\n  padding: 0;\n}\n\n#aejuoezzab .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#aejuoezzab .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#aejuoezzab .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#aejuoezzab .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#aejuoezzab .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#aejuoezzab .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#aejuoezzab .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#aejuoezzab .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#aejuoezzab .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#aejuoezzab .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#aejuoezzab .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#aejuoezzab .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#aejuoezzab .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#aejuoezzab .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#aejuoezzab .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#aejuoezzab .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#aejuoezzab .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#aejuoezzab .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#aejuoezzab .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#aejuoezzab .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#aejuoezzab .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#aejuoezzab .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#aejuoezzab .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#aejuoezzab .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#aejuoezzab .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#aejuoezzab .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#aejuoezzab .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#aejuoezzab .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#aejuoezzab .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#aejuoezzab .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#aejuoezzab .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#aejuoezzab .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#aejuoezzab .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#aejuoezzab .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#aejuoezzab .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#aejuoezzab .gt_left {\n  text-align: left;\n}\n\n#aejuoezzab .gt_center {\n  text-align: center;\n}\n\n#aejuoezzab .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#aejuoezzab .gt_font_normal {\n  font-weight: normal;\n}\n\n#aejuoezzab .gt_font_bold {\n  font-weight: bold;\n}\n\n#aejuoezzab .gt_font_italic {\n  font-style: italic;\n}\n\n#aejuoezzab .gt_super {\n  font-size: 65%;\n}\n\n#aejuoezzab .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#aejuoezzab .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#aejuoezzab .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#aejuoezzab .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#aejuoezzab .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#aejuoezzab .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#aejuoezzab .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#aejuoezzab .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#aejuoezzab div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"label\"><span data-qmd-base64=\"KipDaGFyYWN0ZXJpc3RpYyoq\"><span class='gt_from_md'><strong>Characteristic</strong></span></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"stat_0\"><span data-qmd-base64=\"KipOID0gMSw3NjMqKg==\"><span class='gt_from_md'><strong>N = 1,763</strong></span></span><span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;\"><sup>1</sup></span></th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">Wear type: Are you wearing the light logger at the moment?</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\"><br /></td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Wear</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">1,535 (87%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Non-wear</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">132 (7.5%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Bedtime</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">88 (5.0%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">Activity</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\"><br /></td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Sedentary</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">728 (47%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Light activity</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">693 (45%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Moderate activity</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">103 (6.7%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    High-intensity activity</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">11 (0.7%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">Non-wear wearable position</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\"><br /></td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Dark stationary</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">13 (9.8%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Dark mobile</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">22 (17%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Stationary</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">88 (67%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Other</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">9 (6.8%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">Nightstand wearable measurement direction</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\"><br /></td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Upward</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">78 (89%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Downward</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">5 (5.7%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Other</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">5 (5.7%)</td></tr>\n  </tbody>\n  \n  <tfoot class=\"gt_footnotes\">\n    <tr>\n      <td class=\"gt_footnote\" colspan=\"2\"><span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;\"><sup>1</sup></span> <span data-qmd-base64=\"biAoJSk=\"><span class='gt_from_md'>n (%)</span></span></td>\n    </tr>\n  </tfoot>\n</table>\n</div>\n```\n\n:::\n\n```{.r .cell-code}\ngtsave(event_tbl_wear |> as_gt(), \"tables/table4.png\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nfile:////var/folders/9p/326_k3kx43qbn_cyl1rqfhb00000gn/T//RtmpMgDt2v/filed2026ec0f341.html screenshot completed\n```\n\n\n:::\n\n```{.r .cell-code}\nevent_tbl_other <- \nevents_complete |> \n  select(social_context, setting_light, scenario_daylight, \n         scenario_electric, autonomy\n         ) |> \n  tbl_summary(\n    missing_text = \"Missing\"\n  )\n\nevent_tbl_other\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"dyznyvzrnd\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#dyznyvzrnd table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#dyznyvzrnd thead, #dyznyvzrnd tbody, #dyznyvzrnd tfoot, #dyznyvzrnd tr, #dyznyvzrnd td, #dyznyvzrnd th {\n  border-style: none;\n}\n\n#dyznyvzrnd p {\n  margin: 0;\n  padding: 0;\n}\n\n#dyznyvzrnd .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#dyznyvzrnd .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#dyznyvzrnd .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#dyznyvzrnd .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#dyznyvzrnd .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#dyznyvzrnd .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#dyznyvzrnd .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#dyznyvzrnd .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#dyznyvzrnd .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#dyznyvzrnd .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#dyznyvzrnd .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#dyznyvzrnd .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#dyznyvzrnd .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#dyznyvzrnd .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#dyznyvzrnd .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#dyznyvzrnd .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#dyznyvzrnd .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#dyznyvzrnd .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#dyznyvzrnd .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#dyznyvzrnd .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#dyznyvzrnd .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#dyznyvzrnd .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#dyznyvzrnd .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#dyznyvzrnd .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#dyznyvzrnd .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#dyznyvzrnd .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#dyznyvzrnd .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#dyznyvzrnd .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#dyznyvzrnd .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#dyznyvzrnd .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#dyznyvzrnd .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#dyznyvzrnd .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#dyznyvzrnd .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#dyznyvzrnd .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#dyznyvzrnd .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#dyznyvzrnd .gt_left {\n  text-align: left;\n}\n\n#dyznyvzrnd .gt_center {\n  text-align: center;\n}\n\n#dyznyvzrnd .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#dyznyvzrnd .gt_font_normal {\n  font-weight: normal;\n}\n\n#dyznyvzrnd .gt_font_bold {\n  font-weight: bold;\n}\n\n#dyznyvzrnd .gt_font_italic {\n  font-style: italic;\n}\n\n#dyznyvzrnd .gt_super {\n  font-size: 65%;\n}\n\n#dyznyvzrnd .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#dyznyvzrnd .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#dyznyvzrnd .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#dyznyvzrnd .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#dyznyvzrnd .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#dyznyvzrnd .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#dyznyvzrnd .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#dyznyvzrnd .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#dyznyvzrnd div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"label\"><span data-qmd-base64=\"KipDaGFyYWN0ZXJpc3RpYyoq\"><span class='gt_from_md'><strong>Characteristic</strong></span></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"stat_0\"><span data-qmd-base64=\"KipOID0gMSw3NjMqKg==\"><span class='gt_from_md'><strong>N = 1,763</strong></span></span><span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;\"><sup>1</sup></span></th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">Are you alone or with others?</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\"><br /></td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Alone</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">1,028 (59%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    With others</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">728 (41%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Missing</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">7</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">Select the setting</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\"><br /></td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Indoors</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">941 (61%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Outdoors</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">351 (23%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Mixed</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">247 (16%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Missing</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">224</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">Daylight conditions</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\"><br /></td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Away from window</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">363 (25%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Direct sunlight</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">216 (15%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Near a window</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">664 (46%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Shade / cloudy</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">210 (14%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Missing</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">310</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">Electric lighting conditions</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\"><br /></td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Dim light</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">242 (19%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Lights off</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">356 (28%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Lights on</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">658 (52%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Missing</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">507</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">autonomy</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\"><br /></td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Yes</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">825 (58%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Partly</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">172 (12%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    No</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">428 (30%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    Missing</td>\n<td headers=\"stat_0\" class=\"gt_row gt_center\">338</td></tr>\n  </tbody>\n  \n  <tfoot class=\"gt_footnotes\">\n    <tr>\n      <td class=\"gt_footnote\" colspan=\"2\"><span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;line-height:0;\"><sup>1</sup></span> <span data-qmd-base64=\"biAoJSk=\"><span class='gt_from_md'>n (%)</span></span></td>\n    </tr>\n  </tfoot>\n</table>\n</div>\n```\n\n:::\n\n```{.r .cell-code}\ngtsave(event_tbl_other |> as_gt(), \"tables/table4.png\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nfile:////var/folders/9p/326_k3kx43qbn_cyl1rqfhb00000gn/T//RtmpMgDt2v/filed2023da26935.html screenshot completed\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nevent_tbl_duration <-\nevents_complete |> \n  # drop_na(setting_light) |>\n  dplyr::mutate(setting_light = \n                  case_when(type == \"Bedtime\" ~ \"Bed\",\n                            type == \"Non-wear\" ~ \"Non-wear\",\n                            .default = setting_light |> as.character()),\n                setting_light = \n                  setting_light |> factor(levels = c(\"Bed\", \"Indoors\", \"Mixed\", \"Outdoors\", \"Non-wear\"))) |> \n  dplyr::summarize(`Daily duration` = sum(status.duration, na.rm = TRUE),\n                   .by = c(setting_light, record_id)) |> \n  dplyr::summarize(`Daily duration` = mean(`Daily duration`),\n                   .by = c(setting_light)) |> \n  dplyr::mutate(`Daily duration` =\n                  `Daily duration` /\n                  sum(as.numeric(`Daily duration`)) *\n                  24*60*60,\n                Percent = \n                  (as.numeric(`Daily duration`)/\n                  sum(as.numeric(`Daily duration`)))\n                  # vec_fmt_percent()\n                ) |> \n  arrange(setting_light) |> \n  gt(rowname_col = \"setting_light\") |> \n  grand_summary_rows( \n                     fns = list(\n      sum ~ sum(.)\n    ),\n    fmt = list(~ fmt_percent(., columns = Percent, decimals = 0), \n               ~ fmt_duration(., columns = `Daily duration`, \n               input_units = \"secs\",\n               max_output_units = 2))\n    ) |> \n  fmt_duration(`Daily duration`, \n               input_units = \"secs\",\n               max_output_units = 2) |> \n  fmt_percent(columns = Percent, decimals = 0) |> \n  sub_missing() |> \n  tab_header(title = \"Mean daily duration in condition\")\n\nevent_tbl_duration\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div id=\"mmqyesmsce\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#mmqyesmsce table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#mmqyesmsce thead, #mmqyesmsce tbody, #mmqyesmsce tfoot, #mmqyesmsce tr, #mmqyesmsce td, #mmqyesmsce th {\n  border-style: none;\n}\n\n#mmqyesmsce p {\n  margin: 0;\n  padding: 0;\n}\n\n#mmqyesmsce .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#mmqyesmsce .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#mmqyesmsce .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#mmqyesmsce .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#mmqyesmsce .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#mmqyesmsce .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#mmqyesmsce .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#mmqyesmsce .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#mmqyesmsce .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#mmqyesmsce .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#mmqyesmsce .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#mmqyesmsce .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#mmqyesmsce .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#mmqyesmsce .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#mmqyesmsce .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#mmqyesmsce .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#mmqyesmsce .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#mmqyesmsce .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#mmqyesmsce .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#mmqyesmsce .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#mmqyesmsce .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#mmqyesmsce .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#mmqyesmsce .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#mmqyesmsce .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#mmqyesmsce .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#mmqyesmsce .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#mmqyesmsce .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#mmqyesmsce .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#mmqyesmsce .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#mmqyesmsce .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#mmqyesmsce .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#mmqyesmsce .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#mmqyesmsce .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#mmqyesmsce .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#mmqyesmsce .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#mmqyesmsce .gt_left {\n  text-align: left;\n}\n\n#mmqyesmsce .gt_center {\n  text-align: center;\n}\n\n#mmqyesmsce .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#mmqyesmsce .gt_font_normal {\n  font-weight: normal;\n}\n\n#mmqyesmsce .gt_font_bold {\n  font-weight: bold;\n}\n\n#mmqyesmsce .gt_font_italic {\n  font-style: italic;\n}\n\n#mmqyesmsce .gt_super {\n  font-size: 65%;\n}\n\n#mmqyesmsce .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#mmqyesmsce .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#mmqyesmsce .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#mmqyesmsce .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#mmqyesmsce .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#mmqyesmsce .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#mmqyesmsce .gt_indent_5 {\n  text-indent: 25px;\n}\n\n#mmqyesmsce .katex-display {\n  display: inline-flex !important;\n  margin-bottom: 0.75em !important;\n}\n\n#mmqyesmsce div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {\n  height: 0px !important;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_heading\">\n      <td colspan=\"3\" class=\"gt_heading gt_title gt_font_normal gt_bottom_border\" style>Mean daily duration in condition</td>\n    </tr>\n    \n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"a::stub\"></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Daily-duration\">Daily duration</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Percent\">Percent</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><th id=\"stub_1_1\" scope=\"row\" class=\"gt_row gt_center gt_stub\">Bed</th>\n<td headers=\"stub_1_1 Daily duration\" class=\"gt_row gt_center\">5h 59m</td>\n<td headers=\"stub_1_1 Percent\" class=\"gt_row gt_right\">25%</td></tr>\n    <tr><th id=\"stub_1_2\" scope=\"row\" class=\"gt_row gt_center gt_stub\">Indoors</th>\n<td headers=\"stub_1_2 Daily duration\" class=\"gt_row gt_center\">10h 6m</td>\n<td headers=\"stub_1_2 Percent\" class=\"gt_row gt_right\">42%</td></tr>\n    <tr><th id=\"stub_1_3\" scope=\"row\" class=\"gt_row gt_center gt_stub\">Mixed</th>\n<td headers=\"stub_1_3 Daily duration\" class=\"gt_row gt_center\">1h 56m</td>\n<td headers=\"stub_1_3 Percent\" class=\"gt_row gt_right\">8%</td></tr>\n    <tr><th id=\"stub_1_4\" scope=\"row\" class=\"gt_row gt_center gt_stub\">Outdoors</th>\n<td headers=\"stub_1_4 Daily duration\" class=\"gt_row gt_center\">1h 31m</td>\n<td headers=\"stub_1_4 Percent\" class=\"gt_row gt_right\">6%</td></tr>\n    <tr><th id=\"stub_1_5\" scope=\"row\" class=\"gt_row gt_center gt_stub\">Non-wear</th>\n<td headers=\"stub_1_5 Daily duration\" class=\"gt_row gt_center\">2h 59m</td>\n<td headers=\"stub_1_5 Percent\" class=\"gt_row gt_right\">12%</td></tr>\n    <tr><th id=\"stub_1_6\" scope=\"row\" class=\"gt_row gt_center gt_stub\">—</th>\n<td headers=\"stub_1_6 Daily duration\" class=\"gt_row gt_center\">1h 25m</td>\n<td headers=\"stub_1_6 Percent\" class=\"gt_row gt_right\">6%</td></tr>\n    <tr><th id=\"grand_summary_stub_1\" scope=\"row\" class=\"gt_row gt_left gt_stub gt_grand_summary_row gt_first_grand_summary_row gt_last_summary_row\">sum</th>\n<td headers=\"grand_summary_stub_1 Daily duration\" class=\"gt_row gt_center gt_grand_summary_row gt_first_grand_summary_row gt_last_summary_row\">1d</td>\n<td headers=\"grand_summary_stub_1 Percent\" class=\"gt_row gt_right gt_grand_summary_row gt_first_grand_summary_row gt_last_summary_row\">100%</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n\n:::\n\n```{.r .cell-code}\ngtsave(event_tbl_duration, \"tables/table5.png\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nfile:////var/folders/9p/326_k3kx43qbn_cyl1rqfhb00000gn/T//RtmpMgDt2v/filed20220d00a42.html screenshot completed\n```\n\n\n:::\n:::\n\n\n\n### Combining Events with light data\n\nIn this step, we expand the light measurements with the event data. To this end, we need to specify start and end times for each log entry and thus state.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nevents_light <-\nevents_complete |> \n  rename(Id = device_id) |>\n  group_by(Id) |> \n  dplyr::mutate(setting_light2 = setting_light,\n                setting_light = \n                  case_when(type == \"Bedtime\" ~ \"Bed\",\n                            type == \"Non-wear\" ~ \"Non-wear\",\n                            .default = setting_light |> as.character()),\n                setting_light = \n                  setting_light |> factor(levels = c(\"Bed\", \"Indoors\", \"Mixed\", \"Outdoors\", \"Non-wear\")),\n                end = case_when(\n                  is.na(lead(Datetime)) ~ (end_dt + ddays(1)),\n                  # Datetime >= end_dt ~ Datetime,\n                  !is.na(lead(Datetime)) ~ lead(Datetime)\n                ) |> as.POSIXct(tz = \"UTC\"),\n                Id = factor(Id),\n                .after = Datetime\n                ) |> \n  rename(start = Datetime) |> \n  select(-c(age:file_path, status.duration, UTC_dt))\n\n#adding event-specific information\nlight_data_ext <- \nlight_data |> \n  select(Id, Datetime, Datetime_UTC, MEDI) |> \n  add_states(events_light, Datetime.colname = Datetime_UTC) |> \n  rename(DatetimeUTC = Datetime) |>\n  rename(Datetime = Datetime_UTC) |> \n  unite(\n    scenario_daylight2, setting_light, scenario_daylight, sep = \": \", remove = FALSE, na.rm = TRUE\n  )  |>\n  dplyr::mutate(\n    scenario_daylight2 =\n      case_when(setting_light %in% c(\"Outdoors\", \"Mixed\", \"Indoors\", \"Bed\") &\n                  !is.na(scenario_daylight) ~\n                  paste(setting_light, scenario_daylight, sep = \": \")),\n    scenario_electric2 = \n      case_when(setting_light %in% c(\"Outdoors\", \"Indoors\", \"Mixed\", \"Bed\") &\n                  !is.na(scenario_electric) ~\n                  paste(setting_light, scenario_electric, sep = \": \"))\n  )\n\n#adding participant-specific information\nparticipant_data <- \n  data_devices_cleaned |> \n  select(-record_id, -data) |> \n  rename(Id = device_id) |> \n  dplyr::mutate(Id = factor(Id))\n\nlight_data_ext <-\n  light_data_ext |> \n  left_join(participant_data, by = \"Id\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nparticipants <- light_data_ext |> pull(Id) |> levels()\n\nlight_data_ext |>\n  gg_days(facetting = FALSE,\n          y.axis.label = \"Melanopic EDI (lx)\") |>\n  gg_state(setting_light, aes_fill = setting_light, alpha = 0.5) +\n  scale_fill_manual(\n    values = c(\n      Bed = \"darkgrey\",\n      `Non-wear` = \"tomato\",\n      Indoors = \"gold\",\n      Outdoors = \"skyblue2\",\n      Mixed = \"lightgreen\"\n    )\n  ) + \n  facet_wrap(~Id, ncol = 5) +\n  labs(fill = \"Condition\")\n```\n\n::: {.cell-output-display}\n![](Analysis_files/figure-html/plotting light data-1.png){width=1920}\n:::\n\n```{.r .cell-code}\nggsave(\"figures/Fig3_overview.png\", width = 10, height = 10, scale = 2)\n\nlight_data_ext |>\n  filter(Id %in% participants[1:24]) |> \n  gg_days(facetting = FALSE,\n          y.axis.label = \"Melanopic EDI (lx)\") |>\n  gg_state(setting_light, aes_fill = setting_light, alpha = 0.5) +\n  scale_fill_manual(\n    values = c(\n      Bed = \"darkgrey\",\n      `Non-wear` = \"tomato\",\n      Indoors = \"gold\",\n      Outdoors = \"skyblue2\",\n      Mixed = \"lightgreen\"\n    )\n  ) + \n  facet_wrap(~Id, ncol = 8) +\n  labs(fill = \"Condition\")\n```\n\n::: {.cell-output-display}\n![](Analysis_files/figure-html/plotting light data-2.png){width=1920}\n:::\n\n```{.r .cell-code}\nggsave(\"figures/Fig3a_overview.png\", width = 14, height = 5, scale = 2)\n\nlight_data_ext |>\n  filter(Id %in% participants[25:47]) |> \n  gg_days(facetting = FALSE,\n          y.axis.label = \"Melanopic EDI (lx)\") |>\n  gg_state(setting_light, aes_fill = setting_light, alpha = 0.5) +\n  scale_fill_manual(\n    values = c(\n      Bed = \"darkgrey\",\n      `Non-wear` = \"tomato\",\n      Indoors = \"gold\",\n      Outdoors = \"skyblue2\",\n      Mixed = \"lightgreen\"\n    )\n  ) + \n  facet_wrap(~Id, ncol = 8) +\n  labs(fill = \"Condition\")\n```\n\n::: {.cell-output-display}\n![](Analysis_files/figure-html/plotting light data-3.png){width=1920}\n:::\n\n```{.r .cell-code}\nggsave(\"figures/Fig3b_overview.png\", width = 14, height = 5, scale = 2)\n```\n:::\n\n\n\n## State analysis\n\nIn this section, we look at melanopic EDI for various conditions.\n\nFirst, we create a function that takes a variable and a filter variable for that column, and creates a histogram off that basis.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhistogram_plot <- function(variable, filter) {\nlight_data_ext |> \n  # drop_na({{ variable }}) |> \n  filter({{ variable }} == filter) |>\n  ggplot(aes(y=1, x = MEDI, slab_fill = after_stat(level))) +\n  # geom_violin() +\n  stat_histinterval(na.rm = TRUE, breaks = 20, align = align_center(at = 0))+\n  stat_pointinterval(na.rm = TRUE, point_size = 10, colour = \"red\") +\n  scale_x_continuous(trans = \"symlog\", breaks = c(0, 10^(0:5)),\n                     labels = expression(0,10^0,10^1, 10^2, 10^3, 10^4, 10^5),\n                     limits = c(0, 10^5)) +\n  theme_void() +\n  scale_color_manual(values = scales::brewer_pal()(3)[-1], aesthetics = \"slab_fill\") +\n  theme_sub_axis_x(text = element_text(size = 30)) +\n  guides(slab_fill = \"none\") +\n  ylim(c(1,2))\n}\n```\n:::\n\n\n\nThe second plot function takes the same inputs, and creates a doubleplot showing *when* these instances occur.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlight_data_1day <- \nlight_data_ext |> \n  aggregate_Datetime(unit = \"1 hour\")\n\ntimeline_plot <- function(variable, filter) {\nlight_data_1day |> \n  dplyr::mutate(\n    state = {{ variable }} == filter,\n    state = ifelse(is.na(state), FALSE, state)\n  ) |> \n  group_by(state) |>\n  select(state, Datetime, MEDI) |> \n  aggregate_Date(\n    date.handler = \\(x) \"2025-09-22\",\n    numeric.handler = \\(x) median(x, na.rm = TRUE),\n    n = n(),\n    lower = quantile(MEDI, p = 0.25, na.rm = TRUE),\n    upper = quantile(MEDI, p = 0.75, na.rm = TRUE)\n  ) |> \n    dplyr::mutate(n = n/sum(n)) |> \n  gap_handler(full.days = TRUE) |> \n  gg_day(\n    facetting = FALSE,\n    geom = \"blank\",\n    jco_color = FALSE, x.axis.breaks = hms::hms(hours = seq(0, 24, by = 6))\n  ) +\n  geom_ribbon(aes(ymin = lower, ymax = upper, fill = state), \n              alpha = 0.25\n              ) +\n  geom_hline(yintercept = 0) +\n  geom_line(\n    aes(colour = state), lwd = 0.5\n  )+\n  geom_point(\n            aes(size = n, colour = state)) +\n  scale_fill_manual(values = c(`TRUE` = \"#EFC000FF\",\n                               `FALSE` = \"darkgrey\")) +\n  scale_color_manual(values = c(`TRUE` = \"#EFC000FF\",\n                                `FALSE` = \"darkgrey\")) +\n  coord_cartesian(ylim = c(0, 10^5)) +\n  scale_size_continuous(range = c(3, 20), limits = c(0,1)) +\n  scale_alpha_continuous(range = c(0.01, 0.5)) +\n  guides(lwd = \"none\", colour = \"none\", fill = \"none\", alpha = \"none\",\n         size = \"none\") +\n  theme_void() +\n  theme_sub_axis(text = element_text(size = 30)) +\n  theme_sub_plot(margin = margin(r = 35)) +\n  scale_y_continuous(trans = \"symlog\", breaks = c(0, 10^(0:5)),\n                     labels = expression(0,10^0,10^1, 10^2, 10^3, 10^4, 10^5),\n                     limits = c(0, 10^5))\n}\n```\n:::\n\n\n\n\nNext, we create a function that also takes a variable, and creates a table containing durations, episodes, and some key metrics.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nduration_tibble <- function(variable) {\n  instances <-\n    light_data_ext |>\n    # group_by() |>\n    extract_states({{ variable }}) |>\n    group_by({{ variable }}) |>\n    summarize_numeric(prefix = \"\",\n                      remove = c(\"start\", \"end\", \"epoch\"))\n  # drop_na()\n  \n  metrics <-\n    light_data_ext |>\n    group_by({{ variable }}) |>\n    dplyr::summarize(\n      mean = mean(MEDI, na.rm = TRUE),\n      min = min(MEDI, na.rm = TRUE),\n      q025 = quantile(MEDI, probs = 0.025, na.rm = TRUE),\n      q250 = quantile(MEDI, probs = 0.17, na.rm = TRUE),\n      median = median(MEDI, na.rm = TRUE),\n      q750 = quantile(MEDI, probs = 0.83, na.rm = TRUE),\n      q975 = quantile(MEDI, probs = 0.975, na.rm = TRUE),\n      max = max(MEDI, na.rm = TRUE),\n    )\n  # drop_na()\n  \n  variable_chr <- rlang::ensym(variable) |> as_string()\n  \n  left_join(instances, metrics, by = variable_chr) |> \n  drop_na()\n}\n```\n:::\n\n\n\nLastly, a function to create the actual table. It takes both the `duration_tibble()` and `histogram_plot()` functions and creates a `gt` html table based on it.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nduration_table <- function(variable) {\n  \n  variable_chr <- rlang::ensym(variable) |> as_string()\n  \n  duration_tibble({{ variable }}) |>\n    arrange(desc(median)) |> \n    gt(rowname_col = variable_chr) |>\n    fmt_number(mean:max, decimals = 0) |>\n    cols_add(Plot = {{ variable }}, \n             Plot2 = {{ variable }},\n             .after = max) |>\n    cols_add(rel_duration = total_duration/sum(total_duration), \n             .after = total_duration) |>\n    fmt_percent(rel_duration, decimals = 0) |> \n    cols_label(\n      duration = \"Episode duration\",\n      total_duration = \"Total duration\",\n      episodes = \"Episodes\",\n      mean = \"Mean\",\n      min = \"0%\",\n      q025 = \"2.5%\",\n      q250 = \"17%\",\n      median = \"Median\",\n      q750 = \"83%\",\n      q975 = \"97.5%\",\n      max = \"100%\",\n      Plot = \"Histogram\",\n      Plot2 = \"Timeline\",\n      rel_duration = \"Relative duration\"\n    ) |>\n    text_transform(locations = cells_body(Plot), fn = \\(x) {\n      gt::ggplot_image({\n        x %>%\n          map(\\(y) histogram_plot({{ variable }}, y))\n      }, height = gt::px(75), aspect_ratio = 2)\n    }) |>\n    text_transform(locations = cells_body(Plot2), fn = \\(x) {\n      gt::ggplot_image({\n        x %>%\n          map(\\(y) timeline_plot({{ variable }}, y))\n      }, height = gt::px(75), aspect_ratio = 2)\n    }) |>\n    fmt_duration(2:3, input_units = \"seconds\", max_output_units = 2) |>\n    tab_footnote(\n      \"Scaled histograms show 66% of data in dark blue, 95% of data in dark & light blue, and the most extreme 5% of data in grey. The median is shown as a red dot.\",\n      locations = cells_column_labels(Plot)\n    ) |>\n    tab_footnote(\n      \"Timeline plots show the median of the condition (yellow dot) against the rest of the data (grey dot). Colored bands show the interquartile range. Size of the dots indicates the relative number of instances, i.e., large dots indicate many occurances at a given time (relative to other times).\",\n      locations = cells_column_labels(Plot2)\n    ) |>\n    tab_footnote(\n      \"Average duration of an episode in this category. eps. = Episode(s)\",\n      locations = cells_column_labels(duration)\n    ) |> \n    tab_footnote(\n      \"An episode refers to a log entry in a category, until a different entry\",\n      locations = cells_column_labels(episodes)\n    ) |> \n    # cols_units(mean = \"lx\",\n    #            median = \"lx\") |>\n    gt::tab_spanner(\"Distribution\", min:max) |> \n    tab_footnote(\n      \"Melanopic equivalent daylight illuminance (lx)\",\n      locations = list(cells_column_labels(c(mean)),\n                       cells_column_spanners()\n      )\n    ) |> \n    cols_merge_n_pct(total_duration, rel_duration) |> \n    cols_merge(\n      c(duration, episodes), pattern = \"{1} ({2} eps.)\"\n    ) |> \n    cols_align(\"center\") |> \n    tab_style(\n      style = cell_fill(color = \"grey\"),\n      locations = list(#cells_body(columns = c(min, max)),\n                       cells_column_labels(c(min, max)))\n    ) |> \n    tab_style(\n      style = cell_fill(color = \"tomato\"),\n      locations = list(#cells_body(median),\n                       cells_column_labels(median))\n    ) |> \n    tab_style(\n      style = cell_text(weight = \"bold\"),\n      locations = list(cells_body(median),\n                       cells_stub(),\n                       cells_column_labels(median),\n                       cells_column_spanners())\n    ) |> \n    tab_style(\n      style = cell_fill(color = \"#4880B8\"),\n      locations = list(#cells_body(columns = c(q250, q750)),\n                       cells_column_labels(c(q250, q750)))\n    ) |> \n    tab_style(\n      style = cell_fill(color = \"#C2DAE9\"),\n      locations = list(#cells_body(columns = c(q025, q975)),\n                       cells_column_labels(c(q025, q975)))\n    ) |> \n      cols_move_to_end(c(mean, duration, total_duration)) |> \n    tab_header(\"Summary of melanopic EDI across log entries\",\n               subtitle = glue(\"Question/Characteristic: {label(light_data_ext[[variable_chr]])}\")\n    ) |> \n    tab_style(\n              style = cell_text(color = \"red3\"), \n              locations = cells_stub(\n              # columns = total_duration, # the column whose text you want to style\n              rows    = rel_duration < 0.05   # condition using another column\n    )) |> \n        tab_footnote(\n      \"Red indicates this category represents < 5% of entries\",\n      locations = list(cells_stub(rows    = rel_duration < 0.05)\n      )\n    )\n}\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlabel(light_data_ext$setting_light) <- \"What is your general context?\"\nlabel(light_data_ext$autonomy) <- \"Were the lighting conditions in this setting self-selected?\"\nlabel(light_data_ext$setting_indoors_workingspace) <- \"Indoors setting (work)\"\nlabel(light_data_ext$scenario_daylight2) <- \"Daylight conditions (stratified)\"\nlabel(light_data_ext$scenario_electric2) <- \"Electric lighting conditions (stratified)\"\nlabel(light_data_ext$country) <- \"Country\"\nlabel(light_data_ext$sex) <- \"Sex\"\n\nc(\"social_context\", \"type\", \"setting_light\", \"setting_light2\", \"country\", \"sex\", \"autonomy\", \n  \"setting_indoors\", \"setting_location\", \"setting_outdoors\", \"setting_mixed\",\n  \"nighttime\", \"nonwear_activity\", \"type.detail\", \"setting_specific\", \"setting_indoors_home\", \"setting_indoors_workingspace\", \"setting_indoors_healthfacility\", \"setting_indoors_learningfacility\", \"setting_indoors_retailfacility\", \"scenario_daylight\", \"scenario_electric\", \"screen_phone\", \"screen_tablet\", \"screen_pc\", \"screen_tv\", \"behaviour_change\", \"travel_time_zone\", \"scenario_daylight2\", \"scenario_electric2\", \"wear_activity\"\n  )|>\n  walk(\\(x) {\n    symbol <- sym(x)\n    table <- duration_table(!!symbol)\n    table\n    gtsave(table, glue(\"tables/table_duration_{x}.png\"), vwidth = 1200)\n    })\n```\n:::\n\n\n\n## Time above threshold\n\nIn this section we calculate the time above threshold for the single day of `22 September 2025` across latitude and country.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nTAT250 <- \nlight_data_ext |> \n  filter_Date(start = \"2025-09-22\", length = \"1day\") |> \n  fill(latitude, longitude, city, country, .direction = \"downup\") |> \n  dplyr::summarize(\n    duration_above_threshold(\n      MEDI, Datetime, threshold = 250, na.rm = TRUE,\n      as.df = TRUE\n    ),\n    latitude = unique(latitude),\n    longitude = unique(longitude),\n    city = unique(city),\n    country = unique(country)\n  ) |> \n  mutate(n = n(), .by = country)\n\nTAT250_plot <- function(value){\nTAT250 |> \n  ggplot(aes(x= fct_reorder(Id, duration_above_250), y = duration_above_250))+\n  geom_col(aes(fill = {{ value }})) +\n  scale_fill_viridis_b(labels = \\(x) paste0(x, \"°\"))+\n  scale_y_time(labels = \\(x) x |> as_datetime(tz = \"UTC\") |> format(\"%H:%M\"),\n               expand = FALSE) + \n  theme_minimal() +\n  theme_sub_axis_x(text = element_blank(), line = element_line()) +\n  theme_sub_panel(grid.major.x = element_blank())+\n  labs(x = \"Participants\", y = \"Time above 250lx mel EDI (HH:MM)\")\n}\n\n# TAT250_plot(longitude) / (TAT250_plot(latitude) + ylim(c(10*3600, 0))) + plot_layout(axis = \"collect\", heights = c(1,0.05,1))\n\nTAT250_plot(latitude)\n```\n\n::: {.cell-output-display}\n![](Analysis_files/figure-html/Time above 250 lx mel EDI across participants-1.png){width=672}\n:::\n\n```{.r .cell-code}\nggsave(\"figures/Fig4_TAT250.png\", width = 5, height = 2, scale = 1.5)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nTAT250 |> \n  ggplot(aes(y= fct_reorder(country, duration_above_250), x = duration_above_250))+\n  geom_boxplot(aes(col = n)) +\n  scale_color_viridis_b(breaks = c(1, 3, 5, 10, 15))+\n  scale_x_time(labels = \\(x) x |> as_datetime(tz = \"UTC\") |> format(\"%H:%M\")) + \n  theme_minimal() +\n  # theme_sub_axis_x(text = element_blank(), line = element_line()) +\n  theme_sub_panel(grid.major.y = element_blank())+\n  labs(y = NULL, x = \"Time above 250lx mel EDI (HH:MM)\")\n```\n\n::: {.cell-output-display}\n![](Analysis_files/figure-html/Time above 250 lx mel EDI across countries-1.png){width=672}\n:::\n\n```{.r .cell-code}\nggsave(\"figures/Fig5_TAT250_country.png\", width = 4, height = 3, scale = 1.5)\n```\n:::\n\n\n\n## Global perspectives\n\nIn this section we look at the global distribution of `melanopic EDI`, `Time above 250lx`, and the `Dose` of light.\n\n### Shade data\n\nIn this section we calculate day and night times around the globe. As we want to use this information for a looped visualization, we will set a slightly different cutoff and only collect 48 hours.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Time window (UTC)\nt_start <- ymd_hms(\"2025-09-21 12:00:00\", tz = \"UTC\")\nt_end   <- ymd_hms(\"2025-09-23 12:00:00\", tz = \"UTC\")\n# Step between frames (adjust to taste: \"30 mins\", \"1 hour\", etc.)\ntime_step <- \"15 mins\"\n\n# Spatial grid resolution (degrees). 2° keeps things light; 1° looks smoother but is heavier.\nlon_step <- 0.5\nlat_step <- 0.5\n\n# Darkness mapping: fully dark at civil twilight (-6°), linearly increasing from 0 to 1 as altitude goes 0 -> -6°.\ndark_full_altitude <- -6 # degrees\n\n# ---------- build lon/lat grid ----------\nlons <- seq(-180, 180, by = lon_step)\nlats <- seq(-90,  90,  by = lat_step)\ngrid <- expand.grid(lon = lons, lat = lats) |>\n  as_tibble()\n\n# ---------- time sequence ----------\ntimes_utc <- seq(t_start, t_end, by = time_step)\n\n# ---------- compute sun altitude for each (lon, lat, time) ----------\n# We'll loop over time slices (efficient enough for this grid size),\n# compute altitude (in radians from suncalc), convert to degrees,\n# then map to a \"darkness\" alpha value.\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncompute_slice <- function(tt) {\n  \n  # build a data frame with the timestamp repeated for each grid point\n  df <- data.frame(\n    date = rep(tt, nrow(grid)),\n    lat  = grid$lat,\n    lon  = grid$lon\n  )\n  \n  # call suncalc with a data frame instead of separate lat/lon vectors\n  sp <- suncalc::getSunlightPosition(data = df, keep = c(\"altitude\"))\n  \n  # altitude is returned in radians; convert to degrees\n  alt_deg <- sp$altitude * 180 / pi\n  \n  # darkness mapping (same as before)\n  darkness <- pmin(1, pmax(0, -alt_deg / 6))\n  \n  tibble(\n    lon = grid$lon,\n    lat = grid$lat,\n    time = tt,\n    alt_deg = alt_deg,\n    darkness = darkness\n  )\n}\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Create the progress bar once\npb <- progress_bar$new(\n  format = \"Computing slices [:bar] :percent eta: :eta\",\n  total = length(times_utc), clear = FALSE, width = 70\n)\n\nshade_list <- vector(\"list\", length(times_utc))\n\nfor (i in seq_along(times_utc)) {\n  # Compute one time slice (without pb$tick() inside)\n  shade_list[[i]] <- compute_slice(times_utc[[i]])\n  # Now update the bar\n  pb$tick()\n}\n\nshade_df <- dplyr::bind_rows(shade_list)\n\nshade_df <- bind_rows(lapply(times_utc, compute_slice))\n```\n:::\n\n\n\n### Melanopic EDI\n\n#### Light data\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlight_data_globe <- \nlight_data_ext |> \n    filter_Datetime(DatetimeUTC, start = t_start, end = t_end, tz = \"UTC\") |> \n    select(Id, DatetimeUTC, latitude, longitude, MEDI) |> \n    dplyr::mutate(lat2 = plyr::round_any(latitude, 12), \n           lon2 = plyr::round_any(longitude, 12)) |> \n    ungroup() |> \n    dplyr::summarize(\n        .by = c(DatetimeUTC, lat2, lon2),\n        lat = mean(latitude),\n        lon = mean(longitude),\n        MEDI = mean(MEDI, na.rm = TRUE),\n        n = n()\n    ) |> \n    rename(time = DatetimeUTC)\n\nlight_globe <- st_as_sf(light_data_globe, coords = c(\"lon\", \"lat\"), crs = 4326)\nlight_proj <- st_transform(light_globe, crs = \"+proj=eqc\")\n```\n:::\n\n\n\n#### Plot\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\np <- \n  ggplot() +\n  geom_sf(\n    data = world_proj,\n    fill = \"grey\",\n    color = NA,\n    size = 0.25,\n    alpha = 0.5,\n    show.legend = FALSE\n  ) +\n  geom_sf(data = tz_lines,\n          colour = \"deepskyblue3\",\n          alpha = 0.75,\n          linewidth = 0.1) +\n  geom_tile(\n    data = shade_df,\n    mapping = aes(x = lon, y = lat, alpha = darkness),\n    fill = \"black\",\n    width = lon_step, height = lat_step\n  ) +\n  geom_sf(\n    data = light_proj,\n    aes(size = n, fill = MEDI, colour = MEDI),\n    alpha = 0.9,\n    shape = 21,\n    stroke = 0.2\n  ) +\n  # tile overlay for night shading (black with varying alpha)\n  geom_sf_text(\n    data = locations_proj,\n    aes(label = n),\n    size = 1.9,\n    fontface = 2,\n    color = \"white\",\n    alpha = 0.75\n  ) +\n  scale_alpha(range = c(0, 0.6), limits = c(0, 1), guide = \"none\") +\n  coord_sf(crs = 4326, expand = FALSE, xlim = c(-180, 180), ylim = c(-90, 90)) +\n  # coord_sf(crs = 4326, xlim = c(-180, 180), ylim = c(-90, 90)) +\n  labs(\n    title = \"{format(frame_time, '%Y-%m-%d %H:%M:%S')} (UTC)\",\n    x = NULL, \n    y = NULL\n  ) +\n  guides(size = \"none\",\n        )+\n  labs(fill = \"mel EDI (lx)\", colour = \"mel EDI (lx)\")+\n  scale_fill_viridis_b(trans = \"symlog\", breaks = c(0, 10^(0:5)),\n                       labels = \n                         function(x) format(x, scientific = FALSE, big.mark = \" \"),\n                       limits = c(0, 10^5)) +\n  scale_colour_viridis_b(trans = \"symlog\", breaks = c(0, 10^(0:5)),\n                       labels = \n                         function(x) format(x, scientific = FALSE, big.mark = \" \"),\n                       limits = c(0, 10^5)) +\n  scale_size_continuous(range = c(3, 7.5)) +\n  theme_minimal(base_size = 13) +\n  theme(\n    panel.grid.major = element_line(size = 0.1, colour = \"grey85\"),\n    panel.grid.minor = element_blank(),\n    plot.title = element_text(face = \"bold\"),\n    legend.text.align = 1,\n    legend.text.position = \"left\",\n    legend.position = \"inside\",\n    legend.position.inside = c(0.1,0.35),\n    legend.background = element_rect(fill = alpha(\"white\", alpha = 0.25),\n                                     colour = NA)\n  ) +\n  transition_time(time)\n\n# Frame rate and dimensions\nfps_out <- 12\nwidth_px <- 1400\nheight_px <- 800\n\nif(interactive()) {\n\nanim <- animate(\n  p,\n  duration = 48,\n  fps = fps_out,\n  width = width_px,\n  height = height_px,\n  res = 150,\n  renderer = gifski_renderer(loop = TRUE)\n)\n\nout_file <- \"figures/Fig6_melEDI_global.gif\"\n\nanim_save(out_file, animation = anim)\n\n}\n```\n:::\n\n\n\n## Export for dashboard\n\nIn this section we export key data for the dashboard.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsave(\n     data_devices,\n     events_complete,\n     light_data_ext,\n     histogram_plot,\n     light_data_1day,\n     timeline_plot,\n     duration_tibble,\n     duration_table,\n     TAT250,\n     file = \"data/cleaned/dashboard.RData\")\n```\n:::\n",
    "supporting": [
      "Analysis_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"site_libs/core-js-2.5.3/shim.min.js\"></script>\n<script src=\"site_libs/react-18.2.0/react.min.js\"></script>\n<script src=\"site_libs/react-18.2.0/react-dom.min.js\"></script>\n<script src=\"site_libs/reactwidget-2.0.0/react-tools.js\"></script>\n<script src=\"site_libs/htmlwidgets-1.6.4/htmlwidgets.js\"></script>\n<link href=\"site_libs/reactable-0.4.4/reactable.css\" rel=\"stylesheet\" />\n<script src=\"site_libs/reactable-binding-0.4.4/reactable.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}