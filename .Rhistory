legend.position.inside = c(0.1,0.35)
) +
transition_time(time)
anim <- animate(
p,
duration = 0.25,
fps = fps_out,
width = width_px,
height = height_px,
res = 150,
renderer = gifski_renderer(loop = TRUE)
)
anim_save(out_file, animation = anim)
#| label: Plot mel EDI across the globe
#| warning: false
p <-
ggplot() +
geom_sf(
data = world_proj,
fill = "grey",
color = NA,
size = 0.25,
alpha = 0.5,
show.legend = FALSE
) +
geom_sf(data = tz_lines,
colour = "deepskyblue3",
alpha = 0.75,
linewidth = 0.1) +
geom_tile(
data = shade_df,
mapping = aes(x = lon, y = lat, alpha = darkness),
fill = "black",
width = lon_step, height = lat_step
) +
geom_sf(
data = light_proj,
aes(size = n, fill = MEDI, colour = MEDI),
alpha = 0.9,
shape = 21,
stroke = 0.2
) +
# tile overlay for night shading (black with varying alpha)
geom_sf_text(
data = locations_proj,
aes(label = n),
size = 1.9,
fontface = 2,
color = "white",
alpha = 0.75
) +
scale_alpha(range = c(0, 0.6), limits = c(0, 1), guide = "none") +
coord_sf(crs = 4326, expand = FALSE) +
# coord_sf(crs = 4326, xlim = c(-180, 180), ylim = c(-90, 90)) +
labs(
title = "A day in daylight: {format(frame_time, '%Y-%m-%d %H:%M:%S')} (UTC)",
x = NULL,
y = NULL
) +
guides(size = "none",
)+
labs(fill = "mel EDI (lx)", colour = "mel EDI (lx)")+
scale_fill_viridis_b(trans = "symlog", breaks = c(0, 10^(0:5)),
labels =
function(x) format(x, scientific = FALSE, big.mark = " "),
limits = c(0, 10^5)) +
scale_colour_viridis_b(trans = "symlog", breaks = c(0, 10^(0:5)),
labels =
function(x) format(x, scientific = FALSE, big.mark = " "),
limits = c(0, 10^5)) +
scale_size_continuous(range = c(3, 7.5)) +
theme_minimal(base_size = 13) +
theme(
panel.grid.major = element_line(size = 0.1, colour = "grey85"),
panel.grid.minor = element_blank(),
plot.title = element_text(face = "bold"),
legend.text.align = 1,
legend.text.position = "left",
legend.position = "inside",
legend.position.inside = c(0.1,0.35)
) +
transition_time(time)
anim <- animate(
p,
duration = 0.25,
fps = fps_out,
width = width_px,
height = height_px,
res = 150,
renderer = gifski_renderer(loop = TRUE)
)
anim_save(out_file, animation = anim)
height_px <- 800
anim <- animate(
p,
duration = 0.25,
fps = fps_out,
width = width_px,
height = height_px,
res = 150,
renderer = gifski_renderer(loop = TRUE)
)
anim_save(out_file, animation = anim)
#| label: Plot mel EDI across the globe
#| warning: false
p <-
ggplot() +
geom_sf(
data = world_proj,
fill = "grey",
color = NA,
size = 0.25,
alpha = 0.5,
show.legend = FALSE
) +
geom_sf(data = tz_lines,
colour = "deepskyblue3",
alpha = 0.75,
linewidth = 0.1) +
geom_tile(
data = shade_df,
mapping = aes(x = lon, y = lat, alpha = darkness),
fill = "black",
width = lon_step, height = lat_step
) +
geom_sf(
data = light_proj,
aes(size = n, fill = MEDI, colour = MEDI),
alpha = 0.9,
shape = 21,
stroke = 0.2
) +
# tile overlay for night shading (black with varying alpha)
geom_sf_text(
data = locations_proj,
aes(label = n),
size = 1.9,
fontface = 2,
color = "white",
alpha = 0.75
) +
scale_alpha(range = c(0, 0.6), limits = c(0, 1), guide = "none") +
coord_sf(crs = 4326, expand = FALSE, xlim = c(-180, 180), ylim = c(-90, 90)) +
# coord_sf(crs = 4326, xlim = c(-180, 180), ylim = c(-90, 90)) +
labs(
title = "A day in daylight: {format(frame_time, '%Y-%m-%d %H:%M:%S')} (UTC)",
x = NULL,
y = NULL
) +
guides(size = "none",
)+
labs(fill = "mel EDI (lx)", colour = "mel EDI (lx)")+
scale_fill_viridis_b(trans = "symlog", breaks = c(0, 10^(0:5)),
labels =
function(x) format(x, scientific = FALSE, big.mark = " "),
limits = c(0, 10^5)) +
scale_colour_viridis_b(trans = "symlog", breaks = c(0, 10^(0:5)),
labels =
function(x) format(x, scientific = FALSE, big.mark = " "),
limits = c(0, 10^5)) +
scale_size_continuous(range = c(3, 7.5)) +
theme_minimal(base_size = 13) +
theme(
panel.grid.major = element_line(size = 0.1, colour = "grey85"),
panel.grid.minor = element_blank(),
plot.title = element_text(face = "bold"),
legend.text.align = 1,
legend.text.position = "left",
legend.position = "inside",
legend.position.inside = c(0.1,0.35),
legend.background = element_rect(fill = alpha("white", alpha = 0.25))
) +
transition_time(time)
anim <- animate(
p,
duration = 48,
fps = fps_out,
width = width_px,
height = height_px,
res = 150,
renderer = gifski_renderer(loop = TRUE)
)
anim <- animate(
p,
duration = 1/6,
fps = fps_out,
width = width_px,
height = height_px,
res = 150,
renderer = gifski_renderer(loop = TRUE)
)
anim_save(out_file, animation = anim)
#| label: Plot mel EDI across the globe
#| warning: false
p <-
ggplot() +
geom_sf(
data = world_proj,
fill = "grey",
color = NA,
size = 0.25,
alpha = 0.5,
show.legend = FALSE
) +
geom_sf(data = tz_lines,
colour = "deepskyblue3",
alpha = 0.75,
linewidth = 0.1) +
geom_tile(
data = shade_df,
mapping = aes(x = lon, y = lat, alpha = darkness),
fill = "black",
width = lon_step, height = lat_step
) +
geom_sf(
data = light_proj,
aes(size = n, fill = MEDI, colour = MEDI),
alpha = 0.9,
shape = 21,
stroke = 0.2
) +
# tile overlay for night shading (black with varying alpha)
geom_sf_text(
data = locations_proj,
aes(label = n),
size = 1.9,
fontface = 2,
color = "white",
alpha = 0.75
) +
scale_alpha(range = c(0, 0.6), limits = c(0, 1), guide = "none") +
coord_sf(crs = 4326, expand = FALSE, xlim = c(-180, 180), ylim = c(-90, 90)) +
# coord_sf(crs = 4326, xlim = c(-180, 180), ylim = c(-90, 90)) +
labs(
title = "A day in daylight: {format(frame_time, '%Y-%m-%d %H:%M:%S')} (UTC)",
x = NULL,
y = NULL
) +
guides(size = "none",
)+
labs(fill = "mel EDI (lx)", colour = "mel EDI (lx)")+
scale_fill_viridis_b(trans = "symlog", breaks = c(0, 10^(0:5)),
labels =
function(x) format(x, scientific = FALSE, big.mark = " "),
limits = c(0, 10^5)) +
scale_colour_viridis_b(trans = "symlog", breaks = c(0, 10^(0:5)),
labels =
function(x) format(x, scientific = FALSE, big.mark = " "),
limits = c(0, 10^5)) +
scale_size_continuous(range = c(3, 7.5)) +
theme_minimal(base_size = 13) +
theme(
panel.grid.major = element_line(size = 0.1, colour = "grey85"),
panel.grid.minor = element_blank(),
plot.title = element_text(face = "bold"),
legend.text.align = 1,
legend.text.position = "left",
legend.position = "inside",
legend.position.inside = c(0.1,0.35),
legend.background = element_rect(fill = alpha("white", alpha = 0.25),
colour = NA)
) +
transition_time(time)
#| label: Plot mel EDI across the globe
#| warning: false
p <-
ggplot() +
geom_sf(
data = world_proj,
fill = "grey",
color = NA,
size = 0.25,
alpha = 0.5,
show.legend = FALSE
) +
geom_sf(data = tz_lines,
colour = "deepskyblue3",
alpha = 0.75,
linewidth = 0.1) +
geom_tile(
data = shade_df,
mapping = aes(x = lon, y = lat, alpha = darkness),
fill = "black",
width = lon_step, height = lat_step
) +
geom_sf(
data = light_proj,
aes(size = n, fill = MEDI, colour = MEDI),
alpha = 0.9,
shape = 21,
stroke = 0.2
) +
# tile overlay for night shading (black with varying alpha)
geom_sf_text(
data = locations_proj,
aes(label = n),
size = 1.9,
fontface = 2,
color = "white",
alpha = 0.75
) +
scale_alpha(range = c(0, 0.6), limits = c(0, 1), guide = "none") +
coord_sf(crs = 4326, expand = FALSE, xlim = c(-180, 180), ylim = c(-90, 90)) +
# coord_sf(crs = 4326, xlim = c(-180, 180), ylim = c(-90, 90)) +
labs(
title = "{format(frame_time, '%Y-%m-%d %H:%M:%S')} (UTC)",
x = NULL,
y = NULL
) +
guides(size = "none",
)+
labs(fill = "mel EDI (lx)", colour = "mel EDI (lx)")+
scale_fill_viridis_b(trans = "symlog", breaks = c(0, 10^(0:5)),
labels =
function(x) format(x, scientific = FALSE, big.mark = " "),
limits = c(0, 10^5)) +
scale_colour_viridis_b(trans = "symlog", breaks = c(0, 10^(0:5)),
labels =
function(x) format(x, scientific = FALSE, big.mark = " "),
limits = c(0, 10^5)) +
scale_size_continuous(range = c(3, 7.5)) +
theme_minimal(base_size = 13) +
theme(
panel.grid.major = element_line(size = 0.1, colour = "grey85"),
panel.grid.minor = element_blank(),
plot.title = element_text(face = "bold"),
legend.text.align = 1,
legend.text.position = "left",
legend.position = "inside",
legend.position.inside = c(0.1,0.35),
legend.background = element_rect(fill = alpha("white", alpha = 0.25),
colour = NA)
) +
transition_time(time)
ggplot() +
geom_sf(
data = world_proj,
fill = "grey",
color = NA,
size = 0.25,
alpha = 0.5,
show.legend = FALSE
) +
geom_sf(data = tz_lines,
colour = "deepskyblue3",
alpha = 0.75,
linewidth = 0.1) +
geom_tile(
data = shade_df,
mapping = aes(x = lon, y = lat, alpha = darkness),
fill = "black",
width = lon_step, height = lat_step
) +
geom_sf(
data = light_proj,
aes(size = n, fill = MEDI, colour = MEDI),
alpha = 0.9,
shape = 21,
stroke = 0.2
) +
# tile overlay for night shading (black with varying alpha)
geom_sf_text(
data = locations_proj,
aes(label = n),
size = 1.9,
fontface = 2,
color = "white",
alpha = 0.75
) +
scale_alpha(range = c(0, 0.6), limits = c(0, 1), guide = "none") +
coord_sf(crs = 4326, expand = FALSE, xlim = c(-180, 180), ylim = c(-90, 90)) +
# coord_sf(crs = 4326, xlim = c(-180, 180), ylim = c(-90, 90)) +
labs(
title = "{format(frame_time, '%Y-%m-%d %H:%M:%S')} (UTC)",
x = NULL,
y = NULL
) +
guides(size = "none",
)+
labs(fill = "mel EDI (lx)", colour = "mel EDI (lx)")+
scale_fill_viridis_b(trans = "symlog", breaks = c(0, 10^(0:5)),
labels =
function(x) format(x, scientific = FALSE, big.mark = " "),
limits = c(0, 10^5)) +
scale_colour_viridis_b(trans = "symlog", breaks = c(0, 10^(0:5)),
labels =
function(x) format(x, scientific = FALSE, big.mark = " "),
limits = c(0, 10^5)) +
scale_size_continuous(range = c(3, 7.5)) +
theme_minimal(base_size = 13) +
theme(
panel.grid.major = element_line(size = 0.1, colour = "grey85"),
panel.grid.minor = element_blank(),
plot.title = element_text(face = "bold"),
legend.text.align = 1,
legend.text.position = "left",
legend.position = "inside",
legend.position.inside = c(0.1,0.35),
legend.background = element_rect(fill = alpha("white", alpha = 0.25),
colour = NA)
)
#| label: Plot mel EDI across the globe
#| warning: false
p <-
ggplot() +
geom_sf(
data = world_proj,
fill = "grey",
color = NA,
size = 0.25,
alpha = 0.5,
show.legend = FALSE
) +
geom_sf(data = tz_lines,
colour = "deepskyblue3",
alpha = 0.75,
linewidth = 0.1) +
geom_tile(
data = shade_df,
mapping = aes(x = lon, y = lat, alpha = darkness),
fill = "black",
width = lon_step, height = lat_step
) +
geom_sf(
data = light_proj,
aes(size = n, fill = MEDI, colour = MEDI),
alpha = 0.9,
shape = 21,
stroke = 0.2
) +
# tile overlay for night shading (black with varying alpha)
geom_sf_text(
data = locations_proj,
aes(label = n),
size = 1.9,
fontface = 2,
color = "white",
alpha = 0.75
) +
scale_alpha(range = c(0, 0.6), limits = c(0, 1), guide = "none") +
coord_sf(crs = 4326, expand = FALSE, xlim = c(-180, 180), ylim = c(-90, 90)) +
# coord_sf(crs = 4326, xlim = c(-180, 180), ylim = c(-90, 90)) +
labs(
title = "{format(frame_time, '%Y-%m-%d %H:%M:%S')} (UTC)",
x = NULL,
y = NULL
) +
guides(size = "none",
)+
labs(fill = "mel EDI (lx)", colour = "mel EDI (lx)")+
scale_fill_viridis_b(trans = "symlog", breaks = c(0, 10^(0:5)),
labels =
function(x) format(x, scientific = FALSE, big.mark = " "),
limits = c(0, 10^5)) +
scale_colour_viridis_b(trans = "symlog", breaks = c(0, 10^(0:5)),
labels =
function(x) format(x, scientific = FALSE, big.mark = " "),
limits = c(0, 10^5)) +
scale_size_continuous(range = c(3, 7.5)) +
theme_minimal(base_size = 13) +
theme(
panel.grid.major = element_line(size = 0.1, colour = "grey85"),
panel.grid.minor = element_blank(),
plot.title = element_text(face = "bold"),
legend.text.align = 1,
legend.text.position = "left",
legend.position = "inside",
legend.position.inside = c(0.1,0.35),
legend.background = element_rect(fill = alpha("white", alpha = 0.25),
colour = NA)
) +
transition_time(time)
if(interactive) {
anim <- animate(
p,
duration = 48,
fps = fps_out,
width = width_px,
height = height_px,
res = 150,
renderer = gifski_renderer(loop = TRUE)
)
out_file <- "figures/Fig6_melEDI_global.gif"
anim_save(out_file, animation = anim)
}
if(interactive) {
anim <- animate(
p,
duration = 48,
fps = fps_out,
width = width_px,
height = height_px,
res = 150,
renderer = gifski_renderer(loop = TRUE)
)
out_file <- "figures/Fig6_melEDI_global.gif"
anim_save(out_file, animation = anim)
}
interactive()
if(interactive()) {
anim <- animate(
p,
duration = 48,
fps = fps_out,
width = width_px,
height = height_px,
res = 150,
renderer = gifski_renderer(loop = TRUE)
)
out_file <- "figures/Fig6_melEDI_global.gif"
anim_save(out_file, animation = anim)
}
